<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="prettyprint.xsl"?>
<SimulationScenario
	xmlns="http://aor-simulation.org"
    xmlns:aors="http://aor-simulation.org"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://aor-simulation.org ../../../../../ext/aorsl/AORSL_0-9.xsd"
    version="0.9"
    simulationManagerDirectory="../../../../../"
	scenarioName="CircularTracks"
	scenarioTitle="Circular Tracks">
	
	<SimulationParameters simulationSteps="10000" stepDuration="100" timeUnit="ms" stepTimeDelay="20"/>
	
	<SimulationModel modelName="CircularTracks" modelTitle="Circular Tracks">
		<documentation>
            <dc:creator>Susanne Schoelzel</dc:creator>
            <dc:created>20110620</dc:created>
            <!--<description>
                This simulation models circular tracks.
            </description>-->
        </documentation>
        
        <SpaceModel geometry="Toroidal" spatialDistanceUnit="m">
            <OneDimensional xMax="1000" multiplicity="4" autoKinematics="true"/>
        </SpaceModel>
		
		<EntityTypes>
            <PhysicalAgentType name="Shape2DMap">
            	<Attribute type="Boolean" name="isRectangle"/>
            	
            	<!-- Every 25 steps -->
                <PeriodicTimeEventType name="SwitchShape" periodicity="25"/>
                  
                <ReactionRule name="SwitchShape_Rule" agentVariable="shape2dmap">
                    <WHEN eventType="SwitchShape"/>
                    <DO>
                        <UPDATE-AGT>
                            <Slot property="isRectangle">
                                <ValueExpr language="Java">!shape2dmap.isIsRectangle()</ValueExpr>
                            </Slot>
                        </UPDATE-AGT>
                    </DO>
                </ReactionRule>
        	</PhysicalAgentType>
            
        </EntityTypes>
		
	</SimulationModel>
	<InitialState>
		<PhysicalAgent type="Shape2DMap" id="1" name="Shape2DMap">
			<Slot property="x" value="210"/>
			<Slot property="y" value="1"/>
			<Slot property="vx" value="80"/>
			<Slot property="rotZ" value="-90"/>
			<Slot property="width" value="20"/>
			<Slot property="height" value="20"/>
			<Slot property="isRectangle" value="true"/>
			<PeriodicTimeEvent occurrenceTime="25" type="SwitchShape"/>
		</PhysicalAgent>
	</InitialState>
	<UserInterface supportedLanguages="">
		<AnimationUI>
            <Views>
                <SpaceView canvasColor="grey">
                    <OneDimensionalSpaceView3D mode="circular" trackWidth="30px" trackColor="blue">
                    	<Skybox top="backgrounds\\BlueSkyWithClouds.jpg" bottom="backgrounds\\BlueSkyWithClouds.jpg"
                    			left="backgrounds\\BlueSkyWithClouds.jpg" right="backgrounds\\BlueSkyWithClouds.jpg"
                    			front="backgrounds\\BlueSkyWithClouds.jpg" back="backgrounds\\BlueSkyWithClouds.jpg"/>
                  	</OneDimensionalSpaceView3D>
                </SpaceView>
                
                <PhysicalObjectView physicalObjectIdRef="1">
                    <PhysicalShape2dVisualizationMap property="isRectangle">
                		<Case value="true">
		                    <PhysicalShape2D>
		                        <Triangle fill="yellow"/>
		                    </PhysicalShape2D>
	                    </Case>
	                    <Case value="false">
		                    <PhysicalShape2D>
		                    	<Rectangle fill="lightblue"/>
		                    </PhysicalShape2D>
	                    </Case>
                    </PhysicalShape2dVisualizationMap>
                </PhysicalObjectView>
            </Views>
        </AnimationUI>
	</UserInterface>
</SimulationScenario>
