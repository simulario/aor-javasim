<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="prettyprint.xsl"?>
<SimulationScenario scenarioName="GaltonBox" scenarioTitle="GaltonBox"
                    simulationManagerDirectory="../../.." version="0.9"
                    xsi:schemaLocation="http://aor-simulation.org ../../../../AORSL/AORSL_0-9.xsd"
                    xmlns="http://aor-simulation.org"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:xs="http://www.w3.org/2001/XMLSchema"
                    xmlns:xi="http://www.w3.org/2001/XInclude"
                    xmlns:saxon="http://saxon.sf.net/"
                    xmlns:ns="http://aor-simulation.org"
                    xmlns:h="http://www.w3.org/1999/xhtml"
                    xmlns:dc="http://purl.org/dc/elements/1.1/">
  <SimulationParameters simulationSteps="10000" stepDuration="200"
                        stepTimeDelay="10" timeUnit="ms"></SimulationParameters>

  <SimulationModel modelName="GaltonBox" modelTitle="GaltonBox">
    <documentation>
      <dc:creator>Holger Wuerke</dc:creator>
    </documentation>

    <SpaceModel geometry="Euclidean" spatialDistanceUnit="m">
      <TwoDimensional_LateralView autoCollisionDetection="true"
                                  autoCollisionHandling="true"
                                  autoKinematics="true" xMax="200" yMax="200"></TwoDimensional_LateralView>
    </SpaceModel>

    <Globals>
      <GlobalVariable dataType="Float" name="HPinGap"></GlobalVariable>

      <GlobalVariable dataType="Float" name="VPinGap"></GlobalVariable>

      <GlobalVariable dataType="Float" name="BarHeight"></GlobalVariable>

      <GlobalVariable dataType="Float" name="BarStartX"></GlobalVariable>

      <GlobalVariable dataType="Float" name="PinsPerRow"></GlobalVariable>
    </Globals>

    <EntityTypes>
      <ExogenousEventType name="NewBall">
        <Periodicity>
          <ValueExpr language="Java">30</ValueExpr>
        </Periodicity>
      </ExogenousEventType>

      <PhysicalObjectType name="Ground" physicsType="INFINITE_MASS">
        <InheritedAttributeSettings attribute="width" initialValue="200" />

        <InheritedAttributeSettings attribute="height" initialValue="5" />

        <InheritedAttributeSettings attribute="shape2D"
                                    initialValue="rectangle" />

        <InheritedAttributeSettings attribute="materialType"
                                    initialValue="Iron" />
      </PhysicalObjectType>

      <PhysicalObjectType name="Wall" physicsType="INFINITE_MASS">
        <InheritedAttributeSettings attribute="width" initialValue="5" />

        <InheritedAttributeSettings attribute="height" initialValue="200" />

        <InheritedAttributeSettings attribute="shape2D"
                                    initialValue="rectangle" />

        <InheritedAttributeSettings attribute="materialType"
                                    initialValue="Iron" />
      </PhysicalObjectType>

      <PhysicalObjectType name="Ball">
        <InheritedAttributeSettings attribute="width" initialValue="4" />

        <InheritedAttributeSettings attribute="height" initialValue="4" />

        <InheritedAttributeSettings attribute="shape2D" initialValue="circle" />

        <InheritedAttributeSettings attribute="m" initialValue="1" />

        <InheritedAttributeSettings attribute="materialType"
                                    initialValue="Iron" />
      </PhysicalObjectType>

      <PhysicalObjectType name="Pin" physicsType="INFINITE_MASS">
        <InheritedAttributeSettings attribute="width" initialValue="0.5" />

        <InheritedAttributeSettings attribute="height" initialValue="0.5" />

        <InheritedAttributeSettings attribute="shape2D" initialValue="circle" />

        <InheritedAttributeSettings attribute="materialType"
                                    initialValue="Iron" />
      </PhysicalObjectType>

      <PhysicalObjectType name="Bar" physicsType="INFINITE_MASS">
        <InheritedAttributeSettings attribute="width" initialValue="0.5" />

        <InheritedAttributeSettings attribute="shape2D"
                                    initialValue="rectangle" />

        <InheritedAttributeSettings attribute="materialType"
                                    initialValue="Iron" />
      </PhysicalObjectType>

      <PhysicalObjectType name="StartBar" physicsType="INFINITE_MASS">
        <InheritedAttributeSettings attribute="width" initialValue="50" />

        <InheritedAttributeSettings attribute="height" initialValue="1" />

        <InheritedAttributeSettings attribute="shape2D"
                                    initialValue="rectangle" />
      </PhysicalObjectType>
    </EntityTypes>

    <EnvironmentRules>
      <EnvironmentRule name="NewBall_Rule">
        <WHEN eventType="NewBall" eventVariable="event" />

        <DO>
          <UPDATE-ENV>
            <Create>
              <PhysicalObject type="Ball" y="185">
                <Slot property="x">
                  <ValueExpr language="Java">Random.uniformInt(70 ,130)
                  </ValueExpr>
                </Slot>
              </PhysicalObject>
            </Create>
          </UPDATE-ENV>
        </DO>
      </EnvironmentRule>
    </EnvironmentRules>
  </SimulationModel>

  <InitialState>
    <GlobalVariable name="HPinGap" value="10"></GlobalVariable>

    <GlobalVariable name="VPinGap" value="7.5"></GlobalVariable>

    <GlobalVariable name="BarHeight" value="55"></GlobalVariable>

    <GlobalVariable name="BarStartX" value="10"></GlobalVariable>

    <GlobalVariable name="PinsPerRow" value="20"></GlobalVariable>

    <PhysicalObjects rangeEndID="518" rangeStartID="500" type="Bar">
      <Slot property="height">
        <ValueExpr language="Java">Global.getBarHeight()</ValueExpr>
      </Slot>

      <Slot property="x">
        <ValueExpr language="Java">Global.getBarStartX() + (__bar.getId() -
 500) * Global.getHPinGap() </ValueExpr>
      </Slot>

      <Slot property="y">
        <ValueExpr language="Java">Global.getBarHeight()/2 </ValueExpr>
      </Slot>
    </PhysicalObjects>

    <PhysicalObjects rangeEndID="260" rangeStartID="1" type="Pin">
      <Slot property="x">
        <ValueExpr language="Java">(__pin.getId() % Global.getPinsPerRow()) *
 Global.getHPinGap() + ((int) (__pin.getId() / Global.getPinsPerRow())
 % 2) * Global.getHPinGap()/2 </ValueExpr>
      </Slot>

      <Slot property="y">
        <ValueExpr language="Java">Global.getBarHeight() +
 ((int)(__pin.getId() / Global.getPinsPerRow()) + 1) *
 Global.getVPinGap() </ValueExpr>
      </Slot>
    </PhysicalObjects>

    <PhysicalObject id="900" rotZ="-30" type="StartBar" x="75" y="170"></PhysicalObject>

    <PhysicalObject id="901" rotZ="30" type="StartBar" x="125" y="170"></PhysicalObject>

    <PhysicalObject id="1000" type="Ground" x="100" y="2.5"></PhysicalObject>

    <PhysicalObject id="1001" type="Wall" x="2.5" y="100"></PhysicalObject>

    <PhysicalObject id="1002" type="Wall" x="197.5" y="100"></PhysicalObject>

    <ExogenousEvent occurrenceTime="10" type="NewBall"></ExogenousEvent>
  </InitialState>

  <UserInterface supportedLanguages="de">
    <AnimationUI showZoomControlPanel="true">
      <Views>
        <SpaceView canvasColor="lightgrey">
          <TwoDimensionalSpaceView2D backgroundColor="white"></TwoDimensionalSpaceView2D>
        </SpaceView>

        <PhysicalObjectView physicalObjectType="Ball">
          <PhysicalShape2D>
            <Circle fillOpacity="0.9" fillRGB="200 0 0"></Circle>
          </PhysicalShape2D>
        </PhysicalObjectView>

        <PhysicalObjectView physicalObjectType="Pin">
          <PhysicalShape2D>
            <Circle fillRGB="0 45 86"></Circle>
          </PhysicalShape2D>
        </PhysicalObjectView>

        <PhysicalObjectView physicalObjectType="Bar">
          <PhysicalShape2D>
            <Rectangle fillRGB="0 45 86"></Rectangle>
          </PhysicalShape2D>
        </PhysicalObjectView>

        <PhysicalObjectView physicalObjectType="StartBar">
          <PhysicalShape2D>
            <Rectangle fillRGB="0 45 86"></Rectangle>
          </PhysicalShape2D>
        </PhysicalObjectView>

        <PhysicalObjectView physicalObjectType="Ground">
          <PhysicalShape2D>
            <Rectangle fillRGB="0 45 86"></Rectangle>
          </PhysicalShape2D>
        </PhysicalObjectView>

        <PhysicalObjectView physicalObjectType="Wall">
          <PhysicalShape2D>
            <Rectangle fillRGB="0 45 86"></Rectangle>
          </PhysicalShape2D>
        </PhysicalObjectView>
      </Views>
    </AnimationUI>
  </UserInterface>
</SimulationScenario>
