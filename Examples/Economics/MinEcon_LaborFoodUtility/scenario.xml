<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="prettyprint.xsl"?>

<SimulationScenario xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://aor-simulation.org ../../../AORSL/AORSL_0-8-4.xsd"
 xmlns="http://aor-simulation.org"
 xmlns:dc="http://purl.org/dc/elements/1.1/"
 xmlns:aors="http://aor-simulation.org"
 version="0.8.4"
 scenarioName="MinEcon_LaborFoodUtility_Scenario1"
 scenarioTitle="Minimal Economy with a Labor, Food and Utility Market"
 simulationManagerDirectory="../../..">

	<SimulationParameters simulationSteps="3000" timeUnit="h"  stepTimeDelay="0" randomSeed="47"/>
	<SimulationModel modelName="MinEcon_LaborFoodUtility">
		<documentation>
			<dc:title>Minimal Economy with a Labor, Food and Utility Market</dc:title>
			<dc:title xml:lang="de">Minimale Volkswirtschaft mit Arbeits-, Nahrungsmittel- und Luxusgütermarkt</dc:title>
			<dc:subject>Agent-based computational economics</dc:subject>
			<dc:subject xml:lang="de">Wirtschaftssimulation</dc:subject>
			<dc:creator>Lars Langjahr</dc:creator>
			<dc:created>20101031</dc:created>
			<dc:contributor>Gerd Wagner</dc:contributor>
			<dc:contributor>Gabriel Diaconita</dc:contributor>
			<dc:modified>20101203</dc:modified>
			<dc:source>The Baseline 4 model from the EOS ("Economics via Object-oriented Simulation") project 
				at Princeton University led by Ken Steiglitz, see http://eos.cs.princeton.edu/.</dc:source>
			<aors:shortDescription xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
				Simulates an economy with three goods: labor, food, and "utility", and four types of economic agents: 
				laborers, owners, farms, and utility factories. 
			</aors:shortDescription>
			<aors:shortDescription xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
				Simuliert eine Volkswirtschaft mit drei Gütern: Arbeit, Nahrung und einem abstrakten Luxusgut, 
				sowie vier Arten von ökonomischen Agenten: Arbeiter, Firmenbesitzer, Bauernhöfe und Luxusgutfabriken. 
			</aors:shortDescription>
			<aors:description xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
				This model simulates an economy with three commodities: labor, food, and "utility", 
				and four types of economic agents: laborers, firm owners, farms, and utility factories. 
				Laborers are allotted a certain amount of labor at each step, which they can sell to a 
				farm or utility factory. Laborers can also buy food and utility on the open market with the 
				money that they have earned. Owners simply own a farm or a factory, and collect the profits 
				from these endeavors, which they use to purchase food and utility. Farms hire laborers to 
				produce food, and then sell this food on the open market, giving any profits to their 
				owners. Utility factories operate in the same manner, but produce utility instead of food. 
				Laborer and owners must consume a sufficient quantity of food	at each step or they die. 
				They also seek to purchase utility, which effectively represents all non-essential, 
				desirable goods, with any amount of retained earnings above their target stock.
				For more information, see <a href="http://eos.cs.princeton.edu/DeLuise_JIW05.27.10.pdf">Developing 
				a Micro-Validated Baseline for the EOS Framework</a> by Anthony M. DeLuise.
			</aors:description>
			<aors:description xml:lang="de" xmlns="http://www.w3.org/1999/xhtml">
				Dieses Modell simuliert eine Volkswirtschaft mit drei Gütern: Arbeit, Nahrung und einem 
				abstrakten Luxusgut, sowie vier Arten von ökonomischen Agenten: Arbeiter, Firmenbesitzer, 
				Bauernhöfe und Luxusgüterfabriken. Arbeiter verfügen in jedem Simulationsschritt über eine 
				gewisse Menge and Arbeitskraft, die sie an einen Bauernhof oder eine Fabrik verkaufen können.
				Sie können dann mit dem verdienten Geld Nahrung und Luxusgüter auf dem offenen Markt kaufen.
				Firmenbesitzer besitzen einen Bauernhof oder eine Luxusgüterfabrik. Ihre Einkünfte, mit denen
				sie Nahrung und Luxusgüter kaufen, erhalten	sie aus dem Gewinn dieser Firmen. Bauernhöfe 
				beschäftigen Arbeiter, um Nahrung herzustellen, die sie dann auf dem offenen Markt verkaufen. 
				Die dabei anfallenen Gewinne gehen an ihre Besitzer. Luxusgüterfabriken operieren in derselben
				Weise, außer dass sie Luxusgüter anstatt Nahrung produzieren.	Arbeiter und Firmenbesitzer
				müssen in jedem Schritt eine aureichende Menge an Nahrung konsumieren, um nicht zu sterben. 
				Sie versuchen auch, mit ihrem über einem gewissen Sicherheitslevel liegenden Geldvermögen 
				Luxusgüter zu kaufen.	Weitere Informationen können folgendem Artikel entnommen werden:  
				<a href="http://eos.cs.princeton.edu/DeLuise_JIW05.27.10.pdf">Developing 
				a Micro-Validated Baseline for the EOS Framework</a> by Anthony M. DeLuise.
			</aors:description>
			<informationModelDiagram>EOS.png</informationModelDiagram>
			<dc:license>http://creativecommons.org/licenses/by-nc-sa/2.5/</dc:license>
		</documentation>
		
		<Statistics>
			<Variable name="PriceFood" dataType="Float">	
				<Source>
					<ObjectProperty property="lastMarketPrice" objectType="Market" objectIdRef="2"/>
				</Source>
			</Variable>
			<Variable name="BuyOffersFood" dataType="Float">	
				<Source>
					<ObjectProperty property="buyVolume" objectType="Market" objectIdRef="2"/>
				</Source>
			</Variable>
			<Variable name="SellOffersFood" dataType="Float">	
				<Source>
					<ObjectProperty property="sellVolume" objectType="Market" objectIdRef="2"/>
				</Source>
			</Variable>
			<Variable name="PriceLabor" dataType="Float">	
				<Source>
					<ObjectProperty property="lastMarketPrice" objectType="Market" objectIdRef="3"/>
				</Source>
			</Variable>
			<Variable name="BuyOffersLabor" dataType="Float">	
				<Source>
					<ObjectProperty property="buyVolume" objectType="Market" objectIdRef="3"/>
				</Source>
			</Variable>
			<Variable name="SellOffersLabor" dataType="Float">	
				<Source>
					<ObjectProperty property="sellVolume" objectType="Market" objectIdRef="3"/>
				</Source>
			</Variable>
			<Variable name="PriceUtility" dataType="Float">	
				<Source>
					<ObjectProperty property="lastMarketPrice" objectType="Market" objectIdRef="4"/>
				</Source>
			</Variable>
			<Variable name="BuyOffersUtility" dataType="Float">	
				<Source>
					<ObjectProperty property="buyVolume" objectType="Market" objectIdRef="4"/>
				</Source>
			</Variable>
			<Variable name="SellOffersUtility" dataType="Float">	
				<Source>
					<ObjectProperty property="sellVolume" objectType="Market" objectIdRef="4"/>
				</Source>
				</Variable>
		</Statistics>
		
		<DataTypes>
			<!--====================================-->
			<ComplexDataType name="TradeOffer">
			<!--====================================-->
				<Attribute name="product" type="String"/>
				<Attribute name="price" type="Float"/>
				<Attribute name="Quantity" type="Float"/>
				<Attribute name="buy" type="Boolean"/>
				<Attribute name="bidderIdRef" type="Integer" />
				<!--<ReferenceProperty name="bidder" type="EconomicAgent"/>-->
			</ComplexDataType>
		</DataTypes>
		
		<Globals>
			<!--====================================-->
			<GlobalFunction name="getAssetByName" resultType="aors.util.economics.Quantity">
				<documentation>
					<dc:description> Find an asset from a Quantitylist by String</dc:description>
				</documentation>
				<Parameter name="name" type="String"/>
				<Parameter name="assets" type="List" itemType="aors.util.economics.Quantity"/>
				<Body language="Java"><![CDATA[
					int i;
					for (i=0; i < assets.size(); i++){
						if (!assets.get(i).isDiscrete()) {
							if (((aors.util.economics.ContinuousQuantity)assets.get(i)).getContinuousQuantityType().getName().equals( name)){
								break;
							}
						} else {
							if (((aors.util.economics.DiscreteQuantity)assets.get(i)).getType().equals(name)){
								break;
							}
						}
					}
					return assets.get(i);
					]]></Body>	
				<Body language="JavaScript"><![CDATA[
					var i = 0;
					for (i = 0; i < assets.size(); i++) {
						if (!assets.get(i).isDiscrete()) {
							if (assets.get(i).getContinuousQuantityType().getName() == name)
								break;
						}
						else {
							if (assets.get(i).getType() == name)
								break;
						}
					}
					return assets.get(i);
					]]></Body>	
			</GlobalFunction>
			<!--====================================-->
			<GlobalFunction name="addContinuous" resultType="Double">
				<documentation>
					<dc:description> Adds a ContinuousQuantity to a Quantitylist</dc:description>
				</documentation>
				<Parameter name="quantity" type="Double"/>
				<Parameter name="name" type="String"/>
				<Parameter name="unit" type="String"/>
				<Parameter name="assets" type="List" itemType="aors.util.economics.Quantity"/>
				<Body language="Java"><![CDATA[
					aors.util.economics.ContinuousQuantityType assetType = new aors.util.economics.ContinuousQuantityType(name, unit);
					aors.util.economics.ContinuousQuantity asset = new aors.util.economics.ContinuousQuantity(quantity, assetType);
					assets.add(asset);
					return quantity;
				]]></Body>
				<Body language="JavaScript"><![CDATA[
					var assetType = new aors.util.economics.ContinuousQuantityType(name, unit);
					var asset = new aors.util.economics.ContinuousQuantity(quantity, assetType);
					assets.add(asset);
					return quantity;
				]]></Body>
			</GlobalFunction>
			<!--====================================-->
			<GlobalFunction name="getContinuous" resultType="aors.util.economics.Quantity">
				<documentation>
					<dc:description> Gets a ContinuousQuantity item</dc:description>
				</documentation>
				<Parameter name="quantity" type="Double"/>
				<Parameter name="name" type="String"/>
				<Parameter name="unit" type="String"/>
				<Body language="Java"><![CDATA[
					aors.util.economics.ContinuousQuantityType assetType = new aors.util.economics.ContinuousQuantityType(name, unit);
					aors.util.economics.ContinuousQuantity asset = new aors.util.economics.ContinuousQuantity(quantity, assetType);
					return asset;
				]]></Body>
				<Body language="JavaScript"><![CDATA[
					var assetType = new aors.util.economics.ContinuousQuantityType(name, unit);
					var asset = new aors.util.economics.ContinuousQuantity(quantity, assetType);
					return asset;
				]]></Body>
			</GlobalFunction>
			<!--====================================-->
			<GlobalFunction name="addDiscrete" resultType="Integer">
				<documentation>
					<dc:description> Adds a DiscreteQuantity to a Quantitylist</dc:description>
				</documentation>
				<Parameter name="quantity" type="Integer"/>
				<Parameter name="name" type="String"/>
				<Parameter name="assets" type="List" itemType="aors.util.economics.Quantity"/>
				<Body language="Java"><![CDATA[
					aors.util.economics.DiscreteQuantity asset = new aors.util.economics.DiscreteQuantity( name, (int)quantity);
					assets.add( asset);
					return quantity;
				]]></Body>
				<Body language="JavaScript"><![CDATA[
					var asset = new aors.util.economics.DiscreteQuantity(name, quantity);
					assets.add(asset);
					return quantity;
				]]></Body>
			</GlobalFunction>
			<!--====================================-->
			<GlobalFunction name="getDiscrete" resultType="aors.util.economics.Quantity">
				<documentation>
					<dc:description> Gets DiscreteQuantity item</dc:description>
				</documentation>
				<Parameter name="quantity" type="Integer"/>
				<Parameter name="name" type="String"/>
				<Body language="Java"><![CDATA[
					aors.util.economics.DiscreteQuantity asset = new aors.util.economics.DiscreteQuantity( name, (int)quantity);
					return asset;
				]]></Body>
				<Body language="JavaScript"><![CDATA[
					var asset = new aors.util.economics.DiscreteQuantity(name, quantity);
					return asset;
				]]></Body>
			</GlobalFunction>
		</Globals>
		
		<EntityTypes>
			<!--====================================-->
			<MessageType name="StartOfDay_Notification">
				<!--====================================-->
				<Attribute name="price" type="Float"/>
				<Attribute name="marketType" type="String" />
			</MessageType>
			<!--====================================-->
			<MessageType name="Act_msg" />
			<!--====================================-->
			<MessageType name="OfferToBuyFood">
			<!--====================================-->
				<ComplexDataProperty name="buyOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
			</MessageType>
			<!--====================================-->
			<MessageType name="OfferToSellFood">
				<!--====================================-->
				<ComplexDataProperty name="sellOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
			</MessageType>
			<!--====================================-->
			<MessageType name="OfferToBuyLabor">
				<!--====================================-->
				<ComplexDataProperty name="buyOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
			</MessageType>
			<!--====================================-->
			<MessageType name="OfferToSellLabor">
				<!--====================================-->
				<ComplexDataProperty name="sellOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
			</MessageType>
			<!--====================================-->
			<MessageType name="OfferToBuyUtility">
				<!--====================================-->
				<ComplexDataProperty name="buyOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
			</MessageType>
			<!--====================================-->
			<MessageType name="OfferToSellUtility">
				<!--====================================-->
				<ComplexDataProperty name="sellOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
			</MessageType>
			<!--====================================-->
			<MessageType name="ClearMarket" />
			<!--====================================-->
			<MessageType name="MatchingOffer" >
				<!--====================================-->
				<ComplexDataProperty name="offer" type="TradeOffer"/>
			</MessageType>
			<!--=======================================================-->
			<ExogenousEventType name="StartOfDay" periodicity="9" />
			<!--=======================================================-->
			<ExogenousEventType name="StartWork" periodicity="9" />
			<!--=======================================================-->
			<ExogenousEventType name="CloseMarket" periodicity="9" />
			<!--=======================================================-->
			<ExogenousEventType name="Init" />
			<!-- ============================================ -->
			<AgentType name="EconomicAgent">
			<!-- ============================================ -->
				<documentation><description>A Laborer produces LABOR_ALLOWANCE of labor each timestep.</description></documentation>
				<ComplexDataProperty name="assets" type="aors.util.economics.Quantity" upperMultiplicity="unbounded"/>
				<Attribute name="LABOR_ALLOWANCE" type="Float" initialValue="1.0"/>
				<Attribute name="RANDOM_FACTOR" type="Float" initialValue="0.01"/>
				<Attribute name="lastFoodPrice" type="Float"  initialValue="0"/>
				<Attribute name="lastLaborPrice" type="Float"  initialValue="0"/>
				<Attribute name="lastUtilityPrice" type="Float"  initialValue="0"/>
				<Attribute name="foodAmount" type="Float"  initialValue="0"/>
				<Attribute name="moneyAmount" type="Float"  initialValue="0"/>
				<Attribute name="laborAmount" type="Float"  initialValue="0"/>
				<Attribute name="utilityAmount" type="Float"  initialValue="0"/>
				
				<Function name="updateFood" resultType="Float">
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Updates the food amount by the quantity of the offer</dc:description>
					</documentation>
					<Parameter name="offer" type="TradeOffer"/>
					<Body language="Java"><![CDATA[
						if (offer.getProduct().equals("Food")){
							if (offer.isBuy()) 
								controller.Global.getAssetByName("Food", getAllAssets()).deposit(offer.getQuantity());	
							 else 
								controller.Global.getAssetByName("Food", getAllAssets()).withdraw(offer.getQuantity());
						}
						return controller.Global.getAssetByName("Food", getAllAssets()).getQuantity();
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var assets = this.getAllAssets();
						if (offer.getProduct() == "Food") {
							if (offer.isBuy())
								minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).deposit(offer.getQuantity());	
							else 
								minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).withdraw(offer.getQuantity());
						}
						return minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity();
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="updateMoney" resultType="Float">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Updates the ???gold amount by the quantity times the price of the offer</dc:description>
					</documentation>
					<Parameter name="offer" type="TradeOffer"/>
					<Body language="Java"><![CDATA[
						if (offer.isBuy())
							controller.Global.getAssetByName("Money", getAllAssets()).withdraw(offer.getQuantity() * offer.getPrice());					
						else
							controller.Global.getAssetByName("Money", getAllAssets()).deposit(offer.getQuantity() * offer.getPrice());
						
						return controller.Global.getAssetByName("Money",getAllAssets()).getQuantity();
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var assets = this.getAllAssets();
						if (offer.isBuy()) 
							minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).withdraw(offer.getQuantity() * offer.getPrice());					
						else 
							minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).deposit(offer.getQuantity() * offer.getPrice());
						
						return minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity();
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="updateLabor" resultType="Float">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Updates the labor amount by the quantity of the offer</dc:description>
					</documentation>
					<Parameter name="offer" type="TradeOffer"/>
					<Body language="Java"><![CDATA[
						if (offer.getProduct().equals("Labor")) {
							if (offer.isBuy()) 
								controller.Global.getAssetByName("Labor", getAllAssets()).deposit(offer.getQuantity());
							else 
								controller.Global.getAssetByName("Labor", getAllAssets()).withdraw(offer.getQuantity());
						}
						return controller.Global.getAssetByName("Labor", getAllAssets()).getQuantity();
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var assets = this.getAllAssets();
						if (offer.getProduct() == "Labor") {
							if (offer.isBuy()) 
								minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).deposit(offer.getQuantity());
							else 
								minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).withdraw(offer.getQuantity());
						}
						return minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).getQuantity();
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="updateUtility" resultType="Float">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Updates the foodamount by the quantity of the offer</dc:description>
					</documentation>
					<Parameter name="offer" type="TradeOffer"/>
					<Body language="Java"><![CDATA[
						if (offer.getProduct().equals("Utility")){
							if (offer.isBuy())
								controller.Global.getAssetByName("Utility",getAllAssets()).deposit(offer.getQuantity());
							else
								controller.Global.getAssetByName("Utility",getAllAssets()).withdraw(offer.getQuantity());
						}
						return controller.Global.getAssetByName("Utility",getAllAssets()).getQuantity();										
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var assets = this.getAllAssets();
						if (offer.getProduct() == "Utility") {
							if (offer.isBuy())
								minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Utility", assets).deposit(offer.getQuantity());
						    else 
								minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Utility", assets).withdraw(offer.getQuantity());
						}
						return minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Utility", assets).getQuantity();									
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<ReactionRule name="StartOfDay_Food_Rule">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>The price of the food market is updated</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="StartOfDay_Notification" messageVariable="msg"/>
					<IF language="Java">this.msg.getMarketType().equals("Food")</IF> 
					<IF language="JavaScript">this.msg.getMarketType() == "Food"</IF> 
					<THEN>
						<UPDATE-AGT>
							<Slot property="lastFoodPrice">
								<PropertyValueExpr entityVariable="msg" property="price"/>
							</Slot>
						</UPDATE-AGT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<ReactionRule name="StartOfDay_Labor_Rule">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>The price of the labor market is updated</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="StartOfDay_Notification" messageVariable="msg"/>
					<IF language="Java">this.msg.getMarketType().equals("Labor")</IF>
					<IF language="JavaScript">this.msg.getMarketType() == "Labor"</IF>
					<THEN>
						<UPDATE-AGT>
							<Slot property="lastLaborPrice">
								<PropertyValueExpr entityVariable="msg" property="price"/>
							</Slot>
						</UPDATE-AGT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<ReactionRule name="StartOfDay_Utility_Rule">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>The price of the utility market is updated</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="StartOfDay_Notification" messageVariable="msg"/>
					<IF language="Java">this.msg.getMarketType().equals("Utility")</IF>
					<IF language="JavaScript">this.msg.getMarketType() == "Utility"</IF>
					<THEN>
						<UPDATE-AGT>
							<Slot property="lastUtilityPrice">
								<PropertyValueExpr entityVariable="msg" property="price"/>
							</Slot>
						</UPDATE-AGT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Update_Rule" agentVariable="p">	
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>Succesful transactions are received from the market, food, labor, utility and money are updated</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="MatchingOffer" messageVariable="msg"/>
					<DO>
						<UPDATE-AGT>
							<Slot property="moneyAmount">
								<ValueExpr language="Java JavaScript">this.p.updateMoney(this.msg.getOffer())</ValueExpr>
							</Slot>
							<Slot property="foodAmount">
								<ValueExpr language="Java JavaScript">this.p.updateFood(this.msg.getOffer())</ValueExpr>
							</Slot>
							<Slot property="laborAmount">
								<ValueExpr language="Java JavaScript">this.p.updateLabor(this.msg.getOffer())</ValueExpr>
							</Slot>
							<Slot property="utilityAmount">
								<ValueExpr language="Java JavaScript">this.p.updateUtility(this.msg.getOffer())</ValueExpr>
							</Slot>
						</UPDATE-AGT>
					</DO>
				</ReactionRule>
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="Person" superType="EconomicAgent">
			<!-- ============================================ -->
				<documentation><description>A Person eats EAT_AMOUNT of food each timestep.</description></documentation>
				<Attribute name="EAT_AMOUNT" type="Float" initialValue="1.0"/>
				<Attribute name="TARGET_FOOD_STOCK" type="Float" initialValue="30.0"/>
				<Attribute name="TARGET_MONEY_STOCK" type="Float" initialValue="60.0"/>
				<Attribute name="konto"  type="Float" initialValue="0"/>
				<ReferenceProperty name="firm" type="Firm"/>
				<ComplexDataProperty name="foodBuyList" type="TradeOffer" upperMultiplicity="unbounded"/>
				<ComplexDataProperty name="foodSellList" type="TradeOffer" upperMultiplicity="unbounded"/>
				<ComplexDataProperty name="utilityBuyList" type="TradeOffer" upperMultiplicity="unbounded"/>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="sellFood" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the selloffers and adds them to the foodSellList</dc:description>
					</documentation>
					<Parameter name="bidderIdRef" type="long"/>
					<Body language="Java"><![CDATA[
						getAllFoodSellList().clear();
						if (controller.Global.getAssetByName("Food", getAllAssets()).getQuantity() > 1.5 * getTARGET_FOOD_STOCK()){
				        	final double quantum = getEAT_AMOUNT() * 1.0;
				          	for (double x = controller.Global.getAssetByName("Food", getAllAssets()).getQuantity(); x > 1.5 * getTARGET_FOOD_STOCK(); x -= quantum) {
								if (x == 0.0) x = 0.00000000001;
					            double mod = 0.1 * Math.pow(getTARGET_FOOD_STOCK() / (x - getTARGET_FOOD_STOCK()), .2) + 0.90 + aors.util.Random.uniform(0.0, 1.0) * getRANDOM_FACTOR();
					            double price = mod * getLastFoodPrice();
					            if (price <= 0.0) break;
								
					            model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
					            o.setProduct("Food");
				            	o.setQuantity(quantum);
				            	o.setPrice(price);
				            	o.setBuy(false);
				            	o.setBidderIdRef(bidderIdRef);
				            	getAllFoodSellList().add(o);
				          }
						return true;
						}
						return false;
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var assets = this.getAllAssets();
						this.getAllFoodSellLists().clear();
						
						if (minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity() > 1.5 * this.getTARGET_FOOD_STOCK()) {
							var quantum = this.getEAT_AMOUNT() * 1.0;
							for (var x = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity(); x > 1.5 * this.getTARGET_FOOD_STOCK(); x -= quantum) {
								if (x == 0.0) x = 0.00000000001;
								var random_value = js.util.Random.uniform(0.0, 1.0);
								var mod = 0.1 * Math.pow(this.getTARGET_FOOD_STOCK() / (x - this.getTARGET_FOOD_STOCK()), 0.2) + 0.90 + random_value * this.getRANDOM_FACTOR();
								var price = mod * this.getLastFoodPrice();
								if (price <= 0.0) break;
								
								var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
								o.setProduct("Food");
								o.setQuantity(quantum);
								o.setPrice(price);
								o.setBuy(false);
								
								o.setBidderIdRef(bidderIdRef);
								this.getAllFoodSellLists().add(o);
							}
							return true;
						}
						return false;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="buyUtility" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the buyoffers and adds them to the utilityBuyList</dc:description>
					</documentation>
					<Parameter name="bidderIdRef" type="long"/>
					<Body language="Java"><![CDATA[
						getAllUtilityBuyList().clear();
						double purse = getKonto();
						if (purse > getTARGET_MONEY_STOCK() && controller.Global.getAssetByName("Food", getAllAssets()).getQuantity() > getTARGET_FOOD_STOCK()) {
					      	final double frac = 0.95;
					      	double factor = ((Math.max(Math.min(aors.util.Random.normal(0.0, 1.0), 2.0), -2.0) / 2) * (1 - frac) + 1);
					      	double uPrice = getLastUtilityPrice() * factor;
					      	double quantity = (getKonto() - getTARGET_MONEY_STOCK()) / uPrice;
					      	if (quantity > 0 && uPrice > 0.0){
					      		for (double d = quantity; d > 0; d--){
						        	model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
					            	o.setProduct("Utility");
				            		o.setQuantity(1);
				            		o.setPrice(uPrice);
				            		o.setBuy(true);
				            		o.setBidderIdRef(bidderIdRef);
				            		getAllUtilityBuyList().add(o);
			            		}
			            	}
			            }
			            return true;
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						this.getAllUtilityBuyLists().clear();
						var assets = this.getAllAssets();
						var purse = this.getKonto();
						
						if (purse > this.getTARGET_MONEY_STOCK() && minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity() > this.getTARGET_FOOD_STOCK()) {
							var frac = 0.95;
							var random_value = js.util.Random.normal(0.0, 1.0); 
							var factor = ((Math.max(Math.min(random_value, 2.0), -2.0) / 2) * (1 - frac) + 1);
							var uPrice = this.getLastUtilityPrice() * factor;
							var quantity = (this.getKonto() - this.getTARGET_MONEY_STOCK()) / uPrice;
							if (quantity > 0 && uPrice > 0.0) {
								for (var d = quantity; d > 0; d--) {
									var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
									o.setProduct("Utility");
									o.setQuantity(1);
									o.setPrice(uPrice);
									o.setBuy(true);
									o.setBidderIdRef(bidderIdRef);
									this.getAllUtilityBuyLists().add(o);
								}
							}
						}

						return true;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="SellFood_Rule" agentVariable="p">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description> The person decides how much food he wants to sell</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.p.sellFood(this.p.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToSellFood" receiverIdRefs="2">
								<Slot property="sellOffers">
									<ValueExpr language="Java">this.p.getAllFoodSellList()</ValueExpr>
									<ValueExpr language="JavaScript">this.p.getAllFoodSellLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="BuyUtility_Rule" agentVariable="p">
					<documentation>
						<description> The person decides how much utility he wants to buy</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.p.buyUtility(this.p.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToBuyUtility" receiverIdRefs="4">
								<Slot property="buyOffers">
									<ValueExpr language="Java">this.p.getAllUtilityBuyList()</ValueExpr>
									<ValueExpr language="JavaScript">this.p.getAllUtilityBuyLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="Laborer" superType="Person">
				<!-- ============================================ -->
				<ComplexDataProperty name="laborSellList" type="TradeOffer" upperMultiplicity="unbounded"/>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="buyFood" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the buyoffers and adds them to the foodBuyList</dc:description>
					</documentation>
					<Parameter name="bidder" type="long"/>
					<Body language="Java"><![CDATA[
                    	setKonto(controller.Global.getAssetByName("Money", getAllAssets()).getQuantity());
						getAllFoodBuyList().clear();
						final double quantum = getEAT_AMOUNT() * 1.0;
			          	double purse = controller.Global.getAssetByName("Money", getAllAssets()).getQuantity();
			          	for (double x = controller.Global.getAssetByName("Food", getAllAssets()).getQuantity(); x <= 1.5 * getTARGET_FOOD_STOCK(); x += quantum) {
			            	if (x == 0.0) x = 0.00000000001;
			            	double mod = 0.1 * Math.pow(getTARGET_FOOD_STOCK() / x, 0.2) + 0.90 + aors.util.Random.uniform(0.0, 1.0) * getRANDOM_FACTOR();
			            	double price = mod * getLastFoodPrice();
			            	price = Math.min(price, purse);
			            	if (price <= 0.0) break;
			            	
			              	purse = purse - (quantum*price);
			            	if (purse < 0.0) break;
			            	
			            	model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
			            	o.setProduct("Food");
			            	o.setQuantity(quantum);
			            	o.setPrice(price);
			            	o.setBuy(true);
			            	o.setBidderIdRef(bidder);
			            	getAllFoodBuyList().add(o);
			            	setKonto(getKonto()-price);
			          	}
						return true;
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						assets = this.getAllAssets();
						this.setKonto(minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity());
						this.getAllFoodBuyLists().clear();
						var quantum = this.getEAT_AMOUNT() * 1.0;
						var purse = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity();
						for (var x = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity(); x <= 1.5 * this.getTARGET_FOOD_STOCK(); x += quantum) {
							if (x == 0.0) x = 0.00000000001;
							var random_value = js.util.Random.uniform(0.0, 1.0);
							var mod = 0.1 * Math.pow(this.getTARGET_FOOD_STOCK() / x, 0.2) + 0.90 + random_value * this.getRANDOM_FACTOR();
							var price = mod * this.getLastFoodPrice();
							price = Math.min(price, purse);
							if (price <= 0.0) break;
							
							purse = purse - (quantum * price);
							if (purse < 0.0) break;
							
							var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
							o.setProduct("Food");
							o.setQuantity(quantum);
							o.setPrice(price);
							o.setBuy(true);
							o.setBidderIdRef(bidder);
							this.getAllFoodBuyLists().add(o);
							this.setKonto(this.getKonto() - price);
						}
						return true;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="sellLabor" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the sell offers and adds them to the laborSellList</dc:description>
					</documentation>
					<Parameter name="bidderIdRef" type="long"/>
					<Body language="Java"><![CDATA[
						if (isOwner() == false){
							double price;
							getAllLaborSellList().clear();
							if (getLastLaborPrice() > getLastFoodPrice() && controller.Global.getAssetByName("Food", getAllAssets()).getQuantity() < getTARGET_FOOD_STOCK()){
					        	price = (getLastLaborPrice() - getLastFoodPrice()) * ((controller.Global.getAssetByName("Food", getAllAssets()).getQuantity()*controller.Global.getAssetByName("Food", getAllAssets()).getQuantity()) / (getTARGET_FOOD_STOCK()*getTARGET_FOOD_STOCK())) + getLastFoodPrice();
					        	price = Math.min(price, getLastLaborPrice() * 1.1);
					        }else{
					            price = getLastLaborPrice();
					            final double frac = 0.95;
					            double mod =((Math.max(Math.min(aors.util.Random.normal(0.0, 1.0), 2.0), -2.0) / 2) * (1 - frac) + 1);
					        	price *= mod;
					        }
								model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
					            o.setProduct("Labor");
				            	o.setQuantity(getLABOR_ALLOWANCE());
				            	o.setPrice(price);
				            	o.setBuy(false);
				            	o.setBidderIdRef(bidderIdRef);
				            	getAllLaborSellList().add(o);
				            	return true;
				            
				      }
				      return false;
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						if (!this.isOwner()){ 
							var price = 0;
							var assets = this.getAllAssets();
							this.getAllLaborSellLists().clear();
							if (this.getLastLaborPrice() > this.getLastFoodPrice() && minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity() < this.getTARGET_FOOD_STOCK()){
								price = (this.getLastLaborPrice() - this.getLastFoodPrice()) * ((minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity() * minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity()) / (this.getTARGET_FOOD_STOCK() * this.getTARGET_FOOD_STOCK())) + this.getLastFoodPrice();
								price = Math.min(price, this.getLastLaborPrice() * 1.1);
							} else {
								price = this.getLastLaborPrice();
								var frac = 0.95;
								var random_value = js.util.Random.normal(0.0, 1.0);
								var mod = (Math.max(Math.min(random_value, 2.0), -2) / 2) * (1 - frac) + 1;
								price *= mod;
							}
								var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
								o.setProduct("Labor");
								o.setQuantity(this.getLABOR_ALLOWANCE());
								o.setPrice(price);
								o.setBuy(false);
								o.setBidderIdRef(bidderIdRef);
								this.getAllLaborSellLists().add(o);

								return true;
					  }
					  return false; 
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<ReactionRule name="BuyFood_Rule" agentVariable="p">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description>The person decides how much food he wants to buy</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.p.buyFood(this.p.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToBuyFood" receiverIdRefs="2">
								<Slot property="buyOffers">
									<ValueExpr language="Java">this.p.getAllFoodBuyList()</ValueExpr>
									<ValueExpr language="JavaScript">this.p.getAllFoodBuyLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="SellLabor_Rule" agentVariable="p">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description> The person decides how much labor he wants to sell</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.p.sellLabor(this.p.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToSellLabor" receiverIdRefs="3">
								<Slot property="sellOffers">
									<ValueExpr language="Java">this.p.getAllLaborSellList()</ValueExpr>
									<ValueExpr language="JavaScript">this.p.getAllLaborSellLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="Owner" superType="Person">
				<!-- ============================================ -->
				<Attribute name="TARGET_FIRM_MONEY_STOCK" type="Float" initialValue="100"/>
				<Attribute name="hasFirm" type="Boolean" initialValue="false"/>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="buyFood" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the buyoffers and adds them to the foodBuyList</dc:description>
					</documentation>
					<Parameter name="bidder" type="long"/>
					<Body language="Java"><![CDATA[
						double firmMoney = controller.Global.getAssetByName("Money",getFirm().getAllAssets()).getQuantity();
						double moneyToWithdraw = Math.max(getTARGET_MONEY_STOCK() - controller.Global.getAssetByName("Money", getAllAssets()).getQuantity() , firmMoney - getTARGET_FIRM_MONEY_STOCK());
						if (moneyToWithdraw > 0.0) {
							controller.Global.getAssetByName("Money", getAllAssets()).deposit(controller.Global.getAssetByName("Money", getFirm().getAllAssets()).withdraw(moneyToWithdraw));
                    	}
                    	setKonto(controller.Global.getAssetByName("Money", getAllAssets()).getQuantity());
						getAllFoodBuyList().clear();
						final double quantum = getEAT_AMOUNT() * 1.0;
			          	double purse = controller.Global.getAssetByName("Money", getAllAssets()).getQuantity();
			          	for (double x = controller.Global.getAssetByName("Food", getAllAssets()).getQuantity(); x <= 1.5 * getTARGET_FOOD_STOCK(); x += quantum) {
			            	if (x == 0.0) x = 0.00000000001;
			            	double mod = 0.1 * Math.pow(getTARGET_FOOD_STOCK() / x, 0.2) + 0.90 + aors.util.Random.uniform(0.0, 1.0) * getRANDOM_FACTOR();
			            	double price = mod * getLastFoodPrice();
			            	price = Math.min(price, purse);
			            	if (price <= 0.0) break;
			            	
			              	purse = purse - (quantum*price);
			            	if (purse < 0.0) break;
			            	
			            	model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
			            	o.setProduct("Food");
			            	o.setQuantity(quantum);
			            	o.setPrice(price);
			            	o.setBuy(true);
			            	o.setBidderIdRef(bidder);
			            	getAllFoodBuyList().add(o);
			            	setKonto(getKonto()-price);
			          	}
						return true;
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						assets = this.getAllAssets();
						var firmMoney = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", this.getFirm().getAllAssets()).getQuantity();							
						var moneyToWithdraw = Math.max(this.getTARGET_MONEY_STOCK() - minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity(), firmMoney - this.getTARGET_FIRM_MONEY_STOCK());
						if (moneyToWithdraw > 0.0) {
							var moneyAsset = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets);
							var firmMoneyAsset = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", this.getFirm().getAllAssets());
							moneyAsset.deposit(firmMoneyAsset.withdraw(moneyToWithdraw));
						}
						this.setKonto(minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity());
						this.getAllFoodBuyLists().clear();
						var quantum = this.getEAT_AMOUNT() * 1.0;
						var purse = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity();
						for (var x = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity(); x <= 1.5 * this.getTARGET_FOOD_STOCK(); x += quantum) {
							if (x == 0.0) x = 0.00000000001;
							var random_value = js.util.Random.uniform(0.0, 1.0);
							var mod = 0.1 * Math.pow(this.getTARGET_FOOD_STOCK() / x, 0.2) + 0.90 + random_value * this.getRANDOM_FACTOR();
							var price = mod * this.getLastFoodPrice();
							price = Math.min(price, purse);
							if (price <= 0.0) break;
							
							purse = purse - (quantum * price);
							if (purse < 0.0) break;
							
							var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
							o.setProduct("Food");
							o.setQuantity(quantum);
							o.setPrice(price);
							o.setBuy(true);
							o.setBidderIdRef(bidder);
							this.getAllFoodBuyLists().add(o);
							this.setKonto(this.getKonto() - price);
						}
						return true;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<ReactionRule name="BuyFood_Rule" agentVariable="p">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description>The person decides how much food he wants to buy</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.p.buyFood(this.p.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToBuyFood" receiverIdRefs="2">
								<Slot property="buyOffers">
									<ValueExpr language="Java">this.p.getAllFoodBuyList()</ValueExpr>
									<ValueExpr language="JavaScript">this.p.getAllFoodBuyLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="Firm" superType="EconomicAgent">
				<!-- ============================================ -->
				<Attribute name="amountProduced" type="Float"/>
				<ReferenceProperty name="owner" type="Person"/>
				<ComplexDataProperty name="buyList" type="TradeOffer" upperMultiplicity="unbounded"/>
				<ComplexDataProperty name="sellList" type="TradeOffer" upperMultiplicity="unbounded"/>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="initializeOwnership" resultType="Person">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Finds an owner for a firm</dc:description>
					</documentation>
					<Parameter name="firm" type="Firm"/>
					<Parameter name="owners" type="java.util.List" itemType="aors.model.envsim.Owner"/>
					<Body language="Java"><![CDATA[
						model.envsim.Owner person = null;
						System.out.println(owners);
						/*for (Object o : owners){
							if (((model.envsim.Person)o).isOwner() && !((model.envsim.Person)o).isHasFirm()) {
								person = (model.envsim.Person) o;
								((model.envsim.Person) o).setOwner(true);  //???  why? p is owner, already!
								((model.envsim.Person) o).setHasFirm(true);  //???  why both hasFirm and firm?
								((model.envsim.Person) o).setFirm(firm);
								break;
							}
						}*/	
						return person;
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var person = null;
						for (var i = 0; i < owners.size(); i++){
							var o = owners.get(i);
							if (o.isOwner() == true && !(o.isHasFirm())){
								person = o;
								o.setOwner(true);
								o.setHasFirm(true);
								o.setFirm(firm);
								break;
							}
						}	

						return person;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="changeOwner" resultType="Person">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>removes an owner from a firm</dc:description>
					</documentation>
					<Body language="Java JavaScript"><![CDATA[
						//this.getOwner().setOwner(false);
						this.setOwner(null);
						return this.getOwner();
					]]></Body>
				</Function>
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="Farm" superType="Firm">
				<!-- ============================================ -->
				<Attribute name="TARGET_FOOD_STOCK" type="Float" initialValue="120.0"/>
				<Attribute name="TARGET_OWNER_FOOD_STOCK" type="Float" initialValue="30.0"/>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="sellFood" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the selloffers and adds them to the sellList</dc:description>
					</documentation>
					<Parameter name="bidderIdRef" type="long"/>
					<Body language="Java"><![CDATA[
						getAllSellList().clear();
						double productQuantity = controller.Global.getAssetByName("Food", getAllAssets()).getQuantity();
						if (productQuantity == 0) {
							return false;
						} else {
            				double food = productQuantity;
            				double quantum = productQuantity /10;
							while (food > 0){
								double factor = (Math.max(Math.min(aors.util.Random.normal(0.0, 1.0), 2.0), -2.0) / 2) * 0.1 + 1;
                				double price = getLastFoodPrice() * factor;
                				for (double d = quantum; d > 0; d--){
	                				model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
						            o.setProduct("Food");
					            	o.setQuantity(1);
									o.setPrice(price);
					            	o.setBuy(false);
					            	o.setBidderIdRef(bidderIdRef);
					            	getAllSellList().add(o);
				            	}
				            	food = food - quantum;
            				}
            			return true;
        				}
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						this.getAllSellLists().clear();
						var assets = this.getAllAssets();
						var productQuantity = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity();

						if (productQuantity == 0) {
							return false;
						} else {
							var food = productQuantity;
							var quantum = productQuantity / 10.0;
							while (food > 0) {
							    var random_value = js.util.Random.normal(0.0, 1.0); 
								var factor = (Math.max(Math.min(random_value, 2.0), -2.0)  / 2.0) * 0.1 + 1;
								var price = this.getLastFoodPrice() * factor;
								for (var d = quantum; d > 0; d--) {
									var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
									o.setProduct("Food");
									o.setQuantity(1);
									o.setPrice(price);
									o.setBuy(false);
									o.setBidderIdRef(bidderIdRef);
									this.getAllSellLists().add(o);
								}
								food = food - quantum;
							}
						return true;
						}
						return false;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="buyLabor" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the buyoffers an adds them to the buyList</dc:description>
					</documentation>
					<Parameter name="bidderIdRef" type="long"/>
					<Body language="Java"><![CDATA[
						getAllBuyList().clear();
						double ownerfoodAmount = controller.Global.getAssetByName("Food", getOwner().getAllAssets()).getQuantity();
				        if (ownerfoodAmount < 0.75 * getTARGET_OWNER_FOOD_STOCK() && controller.Global.getAssetByName("Food", getAllAssets()).getQuantity() < getTARGET_FOOD_STOCK()){
				          final double quantum = getLABOR_ALLOWANCE() * 1.0;
				          double purse = controller.Global.getAssetByName("Money", getAllAssets()).getQuantity();
				          for (double x = ownerfoodAmount; x <= 1.5 * getTARGET_OWNER_FOOD_STOCK(); x += quantum) {
				            if (x == 0.0) x = 0.00000000001;
				            double mod = 0.1 * Math.pow(getTARGET_OWNER_FOOD_STOCK() / x, 0.2) + 0.90 + aors.util.Random.uniform(0.0, 1.0) * getRANDOM_FACTOR();
				            double price = mod*getLastLaborPrice();
				            price = Math.min(price, purse);
				            if (price <= 0.0) break;
				            purse -= quantum * price;
				            if (purse < 0.0) break;
				            
				            model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
				            o.setProduct("Labor");
			            	o.setQuantity(quantum);
			            	o.setPrice(price);
			            	o.setBuy(true);
			            	o.setBidderIdRef(bidderIdRef);
			            	getAllBuyList().add(o);        	
				          }
				        }
						double lastProduct = 0.0;
						double minPrice = (getLABOR_ALLOWANCE() * getLastLaborPrice()) / 2.0;
						double purse = controller.Global.getAssetByName("Money", getAllAssets()).getQuantity();
			            for (double d = getLABOR_ALLOWANCE(); purse > 0.0; d += getLABOR_ALLOWANCE()) {
			            	
			                double marginalProduct = convertToFood(d) - lastProduct;
			                if (lastProduct + controller.Global.getAssetByName("Food", getAllAssets()).getQuantity() >= getTARGET_FOOD_STOCK()) break;
			
			                double price = marginalProduct * getLastFoodPrice();
			                // stop when you'd be buying at < 1/2 the price of labor
			                if (price < minPrice) break;
			
			                model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
				            o.setProduct("Labor");
			            	o.setQuantity(getLABOR_ALLOWANCE());
			            	o.setPrice(price);
			            	o.setBuy(true);
			            	o.setBidderIdRef(bidderIdRef);
			            	getAllBuyList().add(o);
			            	purse = purse - price;
			            	lastProduct = lastProduct + marginalProduct;
			            }
						return true;						
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						this.getAllBuyLists().clear();
						var assets = this.getAllAssets();
						var ownerfoodAmount = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", this.getOwner().getAllAssets()).getQuantity();
						if (ownerfoodAmount < 0.75 * this.getTARGET_OWNER_FOOD_STOCK() && minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity() < this.getTARGET_FOOD_STOCK()){
						  var quantum = this.getLABOR_ALLOWANCE() * 1.0;
						  var purse = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity();
						  for (var x = ownerfoodAmount; x <= 1.5 * this.getTARGET_OWNER_FOOD_STOCK(); x += quantum) {
							if (x == 0.0) x = 0.00000000001;
							var random_value = js.util.Random.uniform(0.0, 1.0); 
							var mod = 0.1 * Math.pow(this.getTARGET_OWNER_FOOD_STOCK() / x, 0.2) +  0.90 + random_value * this.getRANDOM_FACTOR();
							var price = mod * this.getLastLaborPrice();
							price = Math.min(price, purse);
							if (price <= 0.0) break;
							purse -= quantum * price;
							if (purse < 0.0) break;
							
							var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
							o.setProduct("Labor");
							o.setQuantity(quantum);
							o.setPrice(price);
							o.setBuy(true);
							o.setBidderIdRef(bidderIdRef);
							this.getAllBuyLists().add(o);        	
						  }
						}
						
						
						var lastProduct = 0.0;
						var minPrice = (this.getLABOR_ALLOWANCE() * this.getLastLaborPrice()) / 2.0;
						var purse = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity();
						for (var d = this.getLABOR_ALLOWANCE(); purse > 0.0; d += this.getLABOR_ALLOWANCE()) {
						
							var marginalProduct = this.convertToFood(d) - lastProduct;
							if (lastProduct + minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).getQuantity() >= this.getTARGET_FOOD_STOCK()) break;

							var price = marginalProduct * this.getLastFoodPrice();
							// stop when you'd be buying at < 1/2 the price of labor
							if (price < minPrice) break;

							var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
							o.setProduct("Labor");
							o.setQuantity(this.getLABOR_ALLOWANCE());
							o.setPrice(price);
							o.setBuy(true);
							o.setBidderIdRef(bidderIdRef);
							this.getAllBuyLists().add(o);
							purse = purse - price;
							lastProduct = lastProduct + marginalProduct;
						}
						return true;						
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="convertToFood" resultType="Float">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates how much food could be produced with a specific amount of labor</dc:description>
					</documentation>
					<Parameter name="laborQuantity" type="double"/>
					<Body language="Java JavaScript"><![CDATA[return (-0.0652 * laborQuantity * laborQuantity) + 4.0652 * laborQuantity;]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="produceFood" resultType="Float">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Converts all labor to food</dc:description>
					</documentation>
					<Parameter name="ID" type="long"/>
					<Body language="Java"><![CDATA[
						double food = convertToFood(controller.Global.getAssetByName("Labor", getAllAssets()).getQuantity());
						double labor = controller.Global.getAssetByName("Labor", getAllAssets()).getQuantity();
						controller.Global.getAssetByName("Labor", getAllAssets()).withdraw(labor);
						controller.Global.getAssetByName("Food", getAllAssets()).deposit(food);
						return food;									
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var assets = this.getAllAssets();
						var food = this.convertToFood(minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).getQuantity());
						var labor = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).getQuantity();
						minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).withdraw(labor);
						minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", assets).deposit(food);
						return food;										
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="ProduceFood_Rule" agentVariable="f">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>Converts all labor to food</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java">Global.getAssetByName("Labor", f.getAllAssets()).getQuantity() > 0</IF>
					<IF language="JavaScript">minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", this.f.getAllAssets()).getQuantity() > 0</IF>
					<THEN>
						<UPDATE-AGT>
							<Slot property="amountProduced">
								<ValueExpr language="Java JavaScript">this.f.produceFood(this.f.getId())</ValueExpr>
							</Slot>
						</UPDATE-AGT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="SellFood_Rule" agentVariable="f">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description>The farm decides how much food he wants to sell</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.f.sellFood(this.f.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToSellFood" receiverIdRefs="2">
								<Slot property="sellOffers">
									<!--<ObjectValueExpr objectVariable="sellList"/>-->
									<ValueExpr language="Java">this.f.getAllSellList()</ValueExpr>
									<ValueExpr language="JavaScript">this.f.getAllSellLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="BuyLabor_Rule" agentVariable="f">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description>The farm decides how much labor he wants to buy</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.f.buyLabor(this.f.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToBuyLabor" receiverIdRefs="3">
								<Slot property="buyOffers">
									<ValueExpr language="Java">this.f.getAllBuyList()</ValueExpr>
									<ValueExpr language="JavaScript">this.f.getAllBuyLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="Factory" superType="Firm">
				<Attribute name="TARGET_UTILITY_STOCK" type="Float" initialValue="60.0"/>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="sellUtility" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the selloffers and adds them to the sellList</dc:description>
					</documentation>
					<Parameter name="bidderIdRef" type="long"/>
					<Body language="Java"><![CDATA[
						getAllSellList().clear();
						final double frac = 0.9;
			            double util = controller.Global.getAssetByName("Utility", getAllAssets()).getQuantity();
			            double quantum = util / 10; 
			            while (util > 0) {
			            	for (double d = quantum; d > 0; d--) {
				            	double factor = ((Math.max(Math.min(aors.util.Random.normal(0.0, 1.0), 2.0), -2.0)/ 2) * (1 - frac) + 1); 
				            	double price = getLastUtilityPrice() * factor;
								
			            		model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
					            o.setProduct("Utility");
				            	o.setQuantity(1);
				            	o.setPrice(price);
				            	o.setBuy(false);
				            	o.setBidderIdRef(bidderIdRef);
				            	getAllSellList().add(o);
			            	}
			            	util = util-quantum;
			            }
            			return true;		
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						var assets = this.getAllAssets();
						this.getAllSellLists().clear();
						var frac = 0.9;
						var util = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Utility", assets).getQuantity();
						var quantum = util / 10.0; 
						while (util > 0) {
							for (var d = quantum; d > 0; d--) {
								var random_value = js.util.Random.normal(0.0, 1.0); 
								var factor = ((Math.max(Math.min(random_value, 2.0), -2.0) / 2) * (1 - frac) + 1); 
								var price = this.getLastUtilityPrice() * factor;
								
								var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
								o.setProduct("Utility");
								o.setQuantity(1);
								o.setPrice(price);
								o.setBuy(false);
								o.setBidderIdRef(bidderIdRef);
								this.getAllSellLists().add(o);
							}
							util = util - quantum;
						}
						return true;	
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="buyLabor" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates the buyoffers an adds them to the buyList</dc:description>
					</documentation>
					<Parameter name="bidderIdRef" type="long"/>
					<Body language="Java"><![CDATA[
						getAllBuyList().clear();
						double lastProduct = 0.0, minPrice = (getLABOR_ALLOWANCE() * getLastLaborPrice()) / 2.0;
						double purse = controller.Global.getAssetByName("Money", getAllAssets()).getQuantity();
			            for (double d = getLABOR_ALLOWANCE(); purse > 0.0; d += getLABOR_ALLOWANCE()) {
			                double marginalProduct = convertToUtility(d) - lastProduct;
			                if (lastProduct + controller.Global.getAssetByName("Utility", getAllAssets()).getQuantity() >= getTARGET_UTILITY_STOCK()) 
								break;
			
			                double price = marginalProduct * getLastUtilityPrice();
			                // stop when you'd be buying at < 1/2 the price of labor
			                if (price < minPrice) break;
			                
							model.dataTypes.TradeOffer o = new model.dataTypes.TradeOffer();
				            o.setProduct("Labor");
			            	o.setQuantity(1);
			            	o.setPrice(price);
			            	o.setBuy(true);
			            	o.setBidderIdRef(bidderIdRef);
			            	getAllBuyList().add(o);
							purse = purse - price; 
			                lastProduct += marginalProduct;
			            }
			        	return true;						
					]]></Body>
					<Body language="JavaScript"><![CDATA[
						this.getAllBuyLists().clear();
						var assets = this.getAllAssets();
						var lastProduct = 0.0;
						var minPrice = (this.getLABOR_ALLOWANCE() * this.getLastLaborPrice()) / 2.0;
						var purse = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", assets).getQuantity();
						for (var d = this.getLABOR_ALLOWANCE(); purse > 0.0; d += this.getLABOR_ALLOWANCE()) {
							var marginalProduct = this.convertToUtility(d) - lastProduct;
							if (lastProduct + minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Utility", assets).getQuantity() >= this.getTARGET_UTILITY_STOCK()) 
								break;

							var price = marginalProduct * this.getLastUtilityPrice();
							// stop when you'd be buying at < 1/2 the price of labor
							if (price < minPrice) break;
							
							var o = new minecon_laborfoodutility_scenario1.model.dataTypes.TradeOffer();
							o.setProduct("Labor");
							o.setQuantity(1);
							o.setPrice(price);
							o.setBuy(true);
							o.setBidderIdRef(bidderIdRef);
							this.getAllBuyLists().add(o);
							purse = purse - price; 
							lastProduct += marginalProduct;
						}
						return true;					
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="convertToUtility" resultType="Integer">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Calculates how much utility could be produced with a specific amount of labor</dc:description>
					</documentation>
					<Parameter name="laborQuantity" type="double"/>
					<Body language="Java"><![CDATA[
						return ((Double)(((-0.0652 * laborQuantity * laborQuantity) + 4.0652 * laborQuantity) / 2.0)).longValue();
					]]></Body>
					<Body language="JavaScript"><![CDATA[
					  var value = ((-0.0652 * laborQuantity * laborQuantity) + 4.0652 * laborQuantity) / 2.0;
					  if (value > 0)
						value = Math.floor(value);
					  else
						value = Math.ceil(value);
					  return value;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="produceUtility" resultType="Integer">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>converts all labor to utility</dc:description>
					</documentation>
					<Body language="Java"><![CDATA[					
						long utility = convertToUtility(controller.Global.getAssetByName("Labor", getAllAssets()).getQuantity());
						double labor = controller.Global.getAssetByName("Labor", getAllAssets()).getQuantity();
						controller.Global.getAssetByName("Labor", getAllAssets()).withdraw(labor);
						controller.Global.getAssetByName("Utility", getAllAssets()).deposit(utility);
						return utility;
					]]></Body>
					<Body language="JavaScript"><![CDATA[		
						var assets = this.getAllAssets(); 
						var utility = this.convertToUtility(minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).getQuantity());
						var labor = minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).getQuantity();
						minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", assets).withdraw(labor);
						minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Utility", assets).deposit(utility);
						return utility;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<ReactionRule name="ProduceUtility_Rule" agentVariable="f">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>Converts all labor to utility</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java">Global.getAssetByName("Labor", f.getAllAssets()).getQuantity() > 0</IF>
					<IF language="JavaScript">minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", this.f.getAllAssets()).getQuantity() > 0</IF>
					<THEN>
						<UPDATE-AGT>
							<Slot property="amountProduced">
								<ValueExpr language="Java JavaScript">this.f.produceUtility()</ValueExpr>
							</Slot>
						</UPDATE-AGT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="SellUtility_Rule" agentVariable="f">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description>The factory decides how much utility he wants to sell</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.f.sellUtility(this.f.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToSellUtility" receiverIdRefs="4">
								<Slot property="sellOffers">
									<ValueExpr language="Java">this.f.getAllSellList()</ValueExpr>
									<ValueExpr language="JavaScript">this.f.getAllSellLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="BuyLabor_Rule" agentVariable="f">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<description> The factory decides how much labor he wants to buy</description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="Act_msg"/>
					<IF language="Java JavaScript">this.f.buyLabor(this.f.getId())</IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="OfferToBuyLabor" receiverIdRefs="3">
								<Slot property="buyOffers">
									<ValueExpr language="Java">this.f.getAllBuyList()</ValueExpr>
									<ValueExpr language="JavaScript">this.f.getAllBuyLists()</ValueExpr>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="Market">
				<!-- ============================================ -->
				<Attribute name="lastMarketPrice" type="Float" initialValue="0"/>
				<Attribute name="lastMarketVolume" type="Float" initialValue="0"/>
				<Attribute name="buyVolume" type="Float" initialValue="0"/>
				<Attribute name="sellVolume" type="Float" initialValue="0"/>
				<Attribute name="commodity" type="String" initialValue=""/>
				<Attribute name="currency" type="String" initialValue=""/>
				<ComplexDataProperty name="buyOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
				<ComplexDataProperty name="sellOffers" type="TradeOffer" upperMultiplicity="unbounded"/>
				<ComplexDataProperty name="transactions" type="TradeOffer" upperMultiplicity="unbounded"/>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="clear" resultType="Boolean">
					<documentation>
						<dc:description>Calculates the market price and adds the corresponding buy- and selloffers to the transactionlist</dc:description>
					</documentation>
					
					<Body language="Java"><![CDATA[
						getAllTransactions().clear();
						java.util.Comparator<model.dataTypes.TradeOffer> comparator;
						comparator = new java.util.Comparator<model.dataTypes.TradeOffer>() {
							public int compare (model.dataTypes.TradeOffer a, model.dataTypes.TradeOffer b) {
							  double p1 = a.getPrice();
							  double p2 = b.getPrice(); 
								if (p1 < p2) return -1;
								if (p1 > p2) return 1;
								            return 0;	             		
							}		
						};
						java.util.Collections.sort(getAllBuyOffers(), comparator);
						java.util.Collections.sort(getAllSellOffers(), comparator);
						
						// handle special cases
				        // highest buy price < lowest sell price -> no transactions OR
				        // empty offer list -> no transactions
				        
				        if ((getAllBuyOffers().size() == 0) || (getAllSellOffers().size() == 0) || (less(getBuyOffers(getAllBuyOffers().size()-1).getPrice(), getSellOffers(0).getPrice()))) {
				        	setBuyVolume(getAllBuyOffers().size());
				        	setSellVolume(getAllSellOffers().size());
				        	getAllBuyOffers().clear();
				        	getAllSellOffers().clear();
				        	return false;
				        }	        
				        // merge prices into sorted list, eliminating duplicates
        				java.util.ArrayList<Double> prices = new java.util.ArrayList<Double>(getAllBuyOffers().size() + getAllSellOffers().size());
        				int s = 0, b = 0;
				        while (s < getAllSellOffers().size() && b < getAllBuyOffers().size()) {
				            if (equal(getSellOffers(s).getPrice(), getBuyOffers(b).getPrice())) {
				            	prices.add(getSellOffers(s++).getPrice());
				                b++;
				            } else if (getSellOffers(s).getPrice() < getBuyOffers(b).getPrice()){
                				prices.add(getSellOffers(s++).getPrice());
                			} else {
                				prices.add(getBuyOffers(b++).getPrice());
                			}
                			// eliminate duplicates in sellOffers
				        	while (s < getAllSellOffers().size() 
                    			   && equal(prices.get(prices.size() - 1), getSellOffers(s).getPrice())){
                				s++;
							}
							// eliminate duplicates in buyOffers
							while (b < getAllBuyOffers().size() && equal(prices.get(prices.size() - 1), getBuyOffers(b).getPrice())){
                				b++;
                			}
                		}
                		// then add the remainder if there is one
        				if (s < getAllSellOffers().size()){
           				 	while (s < getAllSellOffers().size()) {
				                if (!equal(prices.get(prices.size() - 1), getSellOffers(s).getPrice())){
				                	prices.add(getSellOffers(s).getPrice());
				                }
				                s++;
			            	}
			            } else if (b < getAllBuyOffers().size()) {
            				while (b < getAllBuyOffers().size()) {
				                if (!equal(prices.get(prices.size() - 1), getBuyOffers(b).getPrice())){
				                    prices.add(getBuyOffers(b).getPrice());
				                }
				                b++;
				            }
            			}    			
            			// find the price(s) at which supply and demand intersect
				        double supply = 0, demand = 0;
				        // initialize demand to be the demand at lowest demand price
				        for (model.dataTypes.TradeOffer o : getAllBuyOffers()){
				            demand += o.getQuantity();
				        }
				        // walk through prices, updating supply and demand as needed.
				        int p = 0;
				        double bestVolume = Double.NEGATIVE_INFINITY;
				        int bestP = 0;
				        for (s = -1, b = 0; s + 1 < getAllSellOffers().size() && b < getAllBuyOffers().size(); p++) {
				            // if prices[p] is the next supply price:
				            while (s + 1 < getAllSellOffers().size() && equal(prices.get(p), getSellOffers(s + 1).getPrice())){
				                supply += getSellOffers(++s).getQuantity();
				            }
				            // if the current demand price is less than prices[p]:
				            while (b < getAllBuyOffers().size() && less(getBuyOffers(b).getPrice(), prices.get(p))){
				                demand -= getBuyOffers(b++).getQuantity();
				            }
				            if (supply > demand) {
				                // volume = demand
				                if (demand > bestVolume) {
				                    bestVolume = demand;
				                    bestP = p;
				                }
				                break; // stop
				            } else if (supply > bestVolume) {
				            	// volume = supply here
				                bestVolume = supply;
				                bestP = p;
				            }
				        }
			      	  	/*
				         * If the above loop broke because the final supply price was reached,
				         * then supply at Price >= prices[p-1] remains constant. Thus, it is
				         * necessary to check whether demand at higher prices will ever become
				         * less than the current supply. If so, then that will be at the market
				         * price.
				         */
				         if (s + 1 == getAllSellOffers().size()) {
				            for (; b < getAllBuyOffers().size() && p < prices.size(); p++) {
				                while (b < getAllBuyOffers().size() && less(getBuyOffers(b).getPrice(), prices.get(p)))
				                    demand -= getBuyOffers(b++).getQuantity();
				
				                if (supply > demand) {
				                    // volume = demand
				                    if (demand > bestVolume) {
				                        bestVolume = demand;
				                        bestP = p;
				                    }
				                    break; // stop
				                } else if (supply > bestVolume) { 
				                	// volume = supply here
				                    bestVolume = supply;
				                    bestP = p;
				                }
				            }
				        }
				        /*
				         * If one of the loops broke because the next price was greater than the
				         * highest demand price, then the market price is set to the highest
				         * demand price in order to minimize shortage.
				         */
				        if (b == getAllBuyOffers().size()){
				            setLastMarketPrice(getBuyOffers(b - 1).getPrice());
				        }
				        /* If supply never crosses demand, set to highest supply price */
				        else if (p == prices.size()){
				            setLastMarketPrice(getBuyOffers(p - 1).getPrice());
				        }
				        /*
				         * Finally, if the loop broke because supply > demand, there are two
				         * valid prices that could be the market price: prices[p], which is the
				         * smallest price at which supply tops demand, or prices[p-1], which is
				         * the largest price at which demand tops supply. Since either price is
				         * valid, we select between them in an arbitrary, yet deterministic
				         * manner. However, if choosing between a two prices, one of which would
				         * not cause any transactions to occur, we choose the other price.
				         */
				        else {
				            if (p == 0) {
				                setLastMarketPrice(prices.get(p));
				            } else if (less(prices.get(p - 1), getSellOffers(0).getPrice())){
				                setLastMarketPrice(prices.get(p));
				            } else if (less(getBuyOffers(getAllBuyOffers().size() - 1).getPrice(), prices.get(p))){
				                setLastMarketPrice(prices.get(p - 1));
				            } else {
				                setLastMarketPrice(prices.get(bestP));
				            }
				        }
				        int seller = 0, buyer = getAllBuyOffers().size() - 1;
				        while (seller < getAllSellOffers().size() && buyer >= 0 && !less(getLastMarketPrice(), getSellOffers(seller).getPrice()) && !less(getBuyOffers(buyer).getPrice(), getLastMarketPrice())) 
						{	
							getSellOffers(seller).setPrice(getLastMarketPrice());
							getAllTransactions().add(getSellOffers(seller));
							seller++;
							getBuyOffers(buyer).setPrice(getLastMarketPrice());
							getAllTransactions().add(getBuyOffers(buyer));
							buyer--;
				        }
						// reset offer lists and set statistic variables
				        setLastMarketVolume(getAllTransactions().size());
				        setBuyVolume(getAllBuyOffers().size());
				        setSellVolume(getAllSellOffers().size());
				        getAllBuyOffers().clear();
				        getAllSellOffers().clear();
						return true;
					]]></Body>
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<Body language="JavaScript"><![CDATA[
						this.getAllTransactions().clear();
						var buyOffers = this.getAllBuyOffers();
						var sellOffers = this.getAllSellOffers();
						
						var comparator = function(a, b) {
							var p1 = a.getPrice();
							var p2 = b.getPrice();
							
							if (p1 < p2) return -1;
							if (p1 > p2) return 1;
										return 0;	
						}
						
						buyOffers.sort(comparator);
						sellOffers.sort(comparator);
						
						// handle special cases
						// highest buy price < lowest sell price -> no transactions OR
						// empty offer list -> no transactions
						
						if ((buyOffers.size() == 0) || (sellOffers.size() == 0) || (this.less(buyOffers.get(buyOffers.size() - 1).getPrice(), sellOffers.get(0).getPrice()))) {
							
							this.setBuyVolume(buyOffers.size());
							this.setSellVolume(sellOffers.size());
							buyOffers.clear();
							sellOffers.clear();
							return false;
						}
						
						// merge prices into sorted list, eliminating duplicates
						var prices = new js.util.ArrayList();
						var s = 0, b = 0;
						while (s < sellOffers.size() && b < buyOffers.size()) {
							if (this.equal(sellOffers.get(s).getPrice(), buyOffers.get(b).getPrice())) {
								prices.add(sellOffers.get(s++).getPrice());
								b++;
							} else if (sellOffers.get(s).getPrice() < buyOffers.get(b).getPrice()){
								prices.add(sellOffers.get(s++).getPrice());
							} else {
								prices.add(buyOffers.get(b++).getPrice());
							}
							// eliminate duplicates in sellOffers
							while (s < sellOffers.size() && this.equal(prices.get(prices.size() - 1), sellOffers.get(s).getPrice())){
								s++;
							}
							 // eliminate duplicates in buyOffers
							while (b < buyOffers.size() && this.equal(prices.get(prices.size() - 1), buyOffers.get(b).getPrice())){
								b++;
							}
						}
						// then add the remainder if there is one
						if (s < sellOffers.size()) {
								while (s < sellOffers.size()) {
								if (!this.equal(prices.get(prices.size() - 1), sellOffers.get(s).getPrice())){
									prices.add(sellOffers.get(s).getPrice());
								}
								s++;
							}
						} else if (b < buyOffers.size()) {
							while (b < buyOffers.size()) {
								if (!this.equal(prices.get(prices.size() - 1), buyOffers.get(b).getPrice())){
									prices.add(buyOffers.get(b).getPrice());
								}
								b++;
							}
						}
						// find the price(s) at which supply and demand intersect
						var supply = 0, demand = 0;
						
						// initialize demand to be the demand at lowest demand price
						for (var o = 0; o < buyOffers.size(); o++) { 
							var tradeOffer = buyOffers.get(o);
							demand += tradeOffer.getQuantity();
						}
						
						// walk through prices, updating supply and demand as needed.
						var p = 0;
						var bestVolume = Number.NEGATIVE_INFINITY;
						var bestP = 0;
						for (s = -1, b = 0; s + 1 < sellOffers.size() && b < buyOffers.size(); p++) {
							// if prices.get(p) is the next supply price:
							while (s + 1 < sellOffers.size() && this.equal(prices.get(p), sellOffers.get(s + 1).getPrice())) {
								supply += sellOffers.get(++s).getQuantity();
							}
							// if the current demand price is less than prices.get(p):
							while (b < buyOffers.size() && this.less(buyOffers.get(b).getPrice(), prices.get(p))) {
								demand -= buyOffers.get(b++).getQuantity();
							}
							if (supply > demand) {
								// volume = demand
								if (demand > bestVolume) {
									bestVolume = demand;
									bestP = p;
								}
								break; // stop
							} else if (supply > bestVolume) {
								// volume = supply here
								bestVolume = supply;
								bestP = p;
							}
						}
						/*
						 * If the above loop broke because the final supply price was reached,
						 * then supply at Price >= prices.get(p-1) remains constant. Thus, it is
						 * necessary to check whether demand at higher prices will ever become
						 * less than the current supply. If so, then that will be at the market
						 * price.
						 */
						 if (s + 1 == sellOffers.size()) {
							for (; b < buyOffers.size() && p < prices.size(); p++) {
								while (b < buyOffers.size() && this.less(buyOffers.get(b).getPrice(), prices.get(p)))
									demand -= buyOffers.get(b++).getQuantity();
				
								if (supply > demand) {
									// volume = demand
									if (demand > bestVolume) {
										bestVolume = demand;
										bestP = p;
									}
									break; // stop
								} else if (supply > bestVolume) { 
									// volume = supply here
									bestVolume = supply;
									bestP = p;
								}
							}
						}
						/*
						 * If one of the loops broke because the next price was greater than the
						 * highest demand price, then the market price is set to the highest
						 * demand price in order to minimize shortage.
						 */
						if (b == buyOffers.size()) {
							this.setLastMarketPrice(buyOffers.get(b - 1).getPrice());
						}
						/* If supply never crosses demand, set to highest supply price */
						else if (p == prices.size()) {
							this.setLastMarketPrice(buyOffers.get(p - 1).getPrice());
						}
						/*
						 * Finally, if the loop broke because supply > demand, there are two
						 * valid prices that could be the market price: prices.get(p), which is the
						 * smallest price at which supply tops demand, or prices.get(p-1), which is
						 * the largest price at which demand tops supply. Since either price is
						 * valid, we select between them in an arbitrary, yet deterministic
						 * manner. However, if choosing between a two prices, one of which would
						 * not cause any transactions to occur, we choose the other price.
						 */
						else {
							if (p == 0) {
								this.setLastMarketPrice(prices.get(p));
							} else if (this.less(prices.get(p - 1), sellOffers.get(0).getPrice())) {
								this.setLastMarketPrice(prices.get(p));
							} else if (this.less(buyOffers.get(buyOffers.size() - 1).getPrice(), prices.get(p))) {
								this.setLastMarketPrice(prices.get(p - 1));
							} else {
								this.setLastMarketPrice(prices.get(bestP));
							}
						}
						var seller = 0, buyer = buyOffers.size() - 1;
						while (seller < sellOffers.size() && buyer >= 0	&& !this.less(this.getLastMarketPrice(), sellOffers.get(seller).getPrice()) && !this.less(buyOffers.get(buyer).getPrice(), this.getLastMarketPrice())) 
						{	
							sellOffers.get(seller).setPrice(this.getLastMarketPrice());
							this.getAllTransactions().add(sellOffers.get(seller));
							seller++;
							buyOffers.get(buyer).setPrice(this.getLastMarketPrice());
							this.getAllTransactions().add(buyOffers.get(buyer));
							buyer--;
						}
						// reset offer lists and set statistic variables
						this.setLastMarketVolume(this.getAllTransactions().size());
						this.setBuyVolume(buyOffers.size());
						this.setSellVolume(sellOffers.size());
						buyOffers.clear();
						sellOffers.clear();
						return true;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="equal" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>Check if the two Inputparameters are equal</dc:description>
					</documentation>
					<Parameter name="a" type="double"/>
					<Parameter name="b" type="double"/>
					<Body language="Java JavaScript"><![CDATA[
						if (a + 1e-5 < b) 
							return false;
						else if (a - 1e-5 > b) 
							return false;
						else
							return true;
					]]></Body>
				</Function>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
				<Function name="less" resultType="Boolean">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
					<documentation>
						<dc:description>checks if a less b </dc:description>
					</documentation>
					<Parameter name="a" type="double"/>
					<Parameter name="b" type="double"/>
					<Body language="Java JavaScript"><![CDATA[
						return (a + 1e-5 < b);
					]]></Body>
				</Function>
						
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Accept_BuyFood" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>BuyOffers are stored</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="OfferToBuyFood" messageVariable="msg"/>
					<DO>
						<UPDATE-AGT>
							<MultiValuedSlot property="buyOffers">
								<AddAll>
									<ListExpr language="Java">this.msg.getAllBuyOffers()</ListExpr>
									<ListExpr language="JavaScript">this.msg.getAllBuyOffers()</ListExpr>
								</AddAll>
							</MultiValuedSlot>
						</UPDATE-AGT>
					</DO>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Accept_SellFood" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>SellOffers are stored</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="OfferToSellFood" messageVariable="msg"/>
					<DO>
						<UPDATE-AGT>
							<MultiValuedSlot property="sellOffers">
								<AddAll>
									<ListExpr language="Java">this.msg.getAllSellOffers()</ListExpr>
									<ListExpr language="JavaScript">this.msg.getAllSellOffers()</ListExpr>
								</AddAll>
							</MultiValuedSlot>
						</UPDATE-AGT>
					</DO>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Accept_BuyLabor" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>BuyOffers are stored</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="OfferToBuyLabor" messageVariable="msg"/>
					<DO>
						<UPDATE-AGT>
							<MultiValuedSlot property="buyOffers">
								<AddAll>
									<ListExpr language="Java">this.msg.getAllBuyOffers()</ListExpr>
									<ListExpr language="JavaScript">this.msg.getAllBuyOffers()</ListExpr>
								</AddAll>
							</MultiValuedSlot>
						</UPDATE-AGT>
					</DO>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Accept_SellLabor" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>SellOffers are stored</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="OfferToSellLabor" messageVariable="msg"/>
					<DO>
						<UPDATE-AGT>
							<MultiValuedSlot property="sellOffers">
								<AddAll>
									<ListExpr language="Java">this.msg.getAllSellOffers()</ListExpr>
									<ListExpr language="JavaScript">this.msg.getAllSellOffers()</ListExpr>
								</AddAll>
							</MultiValuedSlot>
						</UPDATE-AGT>
					</DO>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Accept_BuyUtility" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>SellOffers are stored</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="OfferToBuyUtility" messageVariable="msg"/>
					<DO>
						<UPDATE-AGT>
							<MultiValuedSlot property="buyOffers">
								<AddAll>
									<ListExpr language="Java">this.msg.getAllBuyOffers()</ListExpr>
									<ListExpr language="JavaScript">this.msg.getAllBuyOffers()</ListExpr>
								</AddAll>
							</MultiValuedSlot>
						</UPDATE-AGT>
					</DO>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Accept_SellUtility" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>SellOffers are stored</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="OfferToSellUtility" messageVariable="msg"/>
					<DO>
						<UPDATE-AGT>
							<MultiValuedSlot property="sellOffers">
								<AddAll>
									<ListExpr language="Java">this.msg.getAllSellOffers()</ListExpr>
									<ListExpr language="JavaScript">this.msg.getAllSellOffers()</ListExpr>
								</AddAll>
							</MultiValuedSlot>
						</UPDATE-AGT>
					</DO>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Clear" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>The market gets cleared</dc:description>
					</documentation>
					<WHEN eventType="InMessageEvent" messageType="ClearMarket"/>
					<IF language="Java JavaScript">this.m.clear()</IF>
					<THEN>
						<SCHEDULE-EVT>
							<ReminderEventExpr>
								<ReminderMsg language="Java JavaScript">"transactions ready"</ReminderMsg>
							</ReminderEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>
				<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
				<ReactionRule name="Transact" agentVariable="m">
					<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
					<documentation>
						<dc:description>Done trades are returned to the persons</dc:description>
					</documentation>
					<WHEN eventType="ReminderEvent" eventVariable="evt" />
					<FOR-ListItemVariable variable="o" listItemType="TradeOffer">
						<!--sollte jetzt so gehen-->
						<ListExpr language="Java JavaScript">this.m.getAllTransactions()</ListExpr>
					</FOR-ListItemVariable>
					<IF language="Java"><![CDATA[ this.evt.getReminderMsg().equals("transactions ready") ]]></IF>
					<IF language="JavaScript"><![CDATA[ this.evt.getReminderMsg() == "transactions ready" ]]></IF>
					<THEN>
						<SCHEDULE-EVT>
							<OutMessageEventExpr messageType="MatchingOffer">
								<ReceiverIdRef language="Java JavaScript">this.o.getBidderIdRef()</ReceiverIdRef>
								<Slot property="offer">		
									<!--sollte jetzt so gehen-->
									<ObjectValueExpr objectVariable="o"/>
								</Slot>
							</OutMessageEventExpr>
						</SCHEDULE-EVT>
					</THEN>
				</ReactionRule>	
			</AgentType>
			<!-- ============================================ -->
			<AgentType name="ContinuousCommodityMarket" superType="Market"></AgentType>
			<AgentType name="DiscreteCommodityMarket" superType="Market"></AgentType>
		</EntityTypes>
		
	<EnvironmentRules>
		<!-- ============================= -->
		<EnvironmentRule name="InitializeOwnership">
		<!-- ============================= -->
			<documentation>
				<dc:description>Finds an owner for all firms</dc:description>
			</documentation>
			<WHEN eventType="Init"/>
			<FOR objectVariable="f" objectType="Firm" />
			<FOR objectVariable="o" objectType="Owner" />
			<DO>
				<UPDATE-ENV>
					<UpdateObject objectVariable="f">
					<Slot property="owner">
						<!--<ValueExpr language="Java">this.f.initializeOwnership(this.f, getEnvironmentSimulator().getObjectsByType(Person.class))</ValueExpr>-->
						<ValueExpr language="Java">this.f.initializeOwnership(o)</ValueExpr>
						<ValueExpr language="JavaScript">this.f.initializeOwnership(this.f, this.getEnvironmentSimulator().getObjectsByType("Person"))</ValueExpr>
					 </Slot>
					</UpdateObject>
				</UPDATE-ENV>
			</DO>
		</EnvironmentRule>
		<!-- ============================= -->
		<EnvironmentRule name="AtStartOfDayEat_ER">
			<!-- ============================= -->
			<documentation>
				<dc:description>Every person tries to eat, if he can't then he dies</dc:description>
			</documentation>
			<WHEN eventType="StartOfDay" eventVariable="evt" />
			<FOR objectVariable="p" objectType="Person" />
			<IF language="Java"><![CDATA[ controller.Global.getAssetByName("Food", this.p.getAllAssets()).withdraw(this.p.getEAT_AMOUNT()) < this.p.getEAT_AMOUNT() ]]></IF>
			<IF language="JavaScript"><![CDATA[ minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", this.p.getAllAssets()).withdraw(this.p.getEAT_AMOUNT()) < this.p.getEAT_AMOUNT() ]]></IF>
			<THEN>
				<UPDATE-ENV>
					<DestroyObject objectVariable="p"/>
				</UPDATE-ENV>
			</THEN>
		</EnvironmentRule>
		<!-- ============================= -->
		<EnvironmentRule name="CheckBankrupt_ER">
			<!-- ============================= -->
			<documentation>
				<dc:description>If a farm  has no more money, food and labor it is shut down</dc:description>
			</documentation>
			<WHEN eventType="StartOfDay" eventVariable="evt" />
			<FOR objectVariable="f" objectType="Farm" />
			<IF language="Java"><![CDATA[ controller.Global.getAssetByName("Food", f.getAllAssets()).getQuantity() == 0.0d && Global.getAssetByName("Labor", f.getAllAssets()).getQuantity() == 0.0d && Global.getAssetByName("Money", f.getAllAssets()).getQuantity() == 0.0d ]]></IF>
			<IF language="JavaScript"><![CDATA[ minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Food", this.f.getAllAssets()).getQuantity() == 0.0 && minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Labor", this.f.getAllAssets()).getQuantity() == 0.0 && minecon_laborfoodutility_scenario1.controller.Global.getAssetByName("Money", this.f.getAllAssets()).getQuantity() == 0.0 ]]></IF>
			<THEN>
				<UPDATE-ENV>
					<UpdateObject objectVariable="f">
						<Slot property="owner">
							<ValueExpr language="Java JavaScript">this.f.changeOwner()</ValueExpr>
						</Slot>
					</UpdateObject>
					<DestroyObject objectVariable="f"/>
				</UPDATE-ENV>
			</THEN>
		</EnvironmentRule>
		<!-- ====================================== -->
		<EnvironmentRule name="StartOfDay_Rule_ER">
			<!-- ====================================== -->
			<documentation>
				<dc:description>
				 For all markets that exist, the market price of the last day is send to every person
				</dc:description>
			</documentation>
			<WHEN eventType="StartOfDay"/>
			<FOR objectVariable="m" objectType="Market" />
			<FOR objectVariable="p" objectType="EconomicAgent" />
			<DO>
				<SCHEDULE-EVT>
					<InMessageEventExpr messageType="StartOfDay_Notification">
					    <SenderIdRef language="Java JavaScript">this.m.getId()</SenderIdRef>
						<ReceiverIdRef language="Java JavaScript">this.p.getId()</ReceiverIdRef>
						<Slot property="price">
							<PropertyValueExpr entityVariable="m" property="lastMarketPrice"/>
						</Slot>
						<Slot property="marketType">
							<PropertyValueExpr entityVariable="m" property="commodity"/>
						</Slot>
					</InMessageEventExpr>
				</SCHEDULE-EVT>
			</DO>
		</EnvironmentRule>
		<!-- ============================= -->
		<EnvironmentRule name="StartWork_ER">
			<!-- ============================= -->
			<documentation>
				<dc:description>Act_msg is sent to every person</dc:description>
			</documentation>
			<WHEN eventType="StartWork"/>
			<FOR objectVariable="p" objectType="EconomicAgent" />
			<DO>
				<SCHEDULE-EVT>
					<InMessageEventExpr messageType="Act_msg" senderIdRef="0">
						<ReceiverIdRef language="Java JavaScript">this.p.getId()</ReceiverIdRef>
					</InMessageEventExpr>
				</SCHEDULE-EVT>
			</DO>
		</EnvironmentRule>	
		<!-- ===================================== -->
		<EnvironmentRule name="CloseMarket_ER">
		<!-- ===================================== -->
			<documentation>
				<dc:description>ClearMarket is send to every market</dc:description>
			</documentation>
			<WHEN eventType="CloseMarket"/>
			<FOR objectVariable="m" objectType="Market" />
			<DO>
				<SCHEDULE-EVT>
					<InMessageEventExpr messageType="ClearMarket" senderIdRef="0">
						<ReceiverIdRef language="Java JavaScript">this.m.getId()</ReceiverIdRef>
					</InMessageEventExpr>
				</SCHEDULE-EVT>
			</DO>
		</EnvironmentRule>
	</EnvironmentRules>	
		
	</SimulationModel>
	<!-- ======================= -->
	<InitialState>
	<!-- ======================= -->
		<Agent name="FoodMarket" id="2" type="ContinuousCommodityMarket">
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->			
			<Slot property="lastMarketPrice" value="0.2" />
			<Slot property="commodity" value="Food"></Slot>
			<Slot property="currency" value="Money"></Slot>
			<Slot property="buyOffers">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="sellOffers">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="transactions">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
		</Agent>
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
		<Agent name="LaborMarket" id="3" type="ContinuousCommodityMarket">
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->			
			<Slot property="lastMarketPrice" value="0.4" />
			<Slot property="commodity" value="Labor"></Slot>
			<Slot property="currency" value="Money"></Slot>
			<Slot property="buyOffers">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="sellOffers">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="transactions">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
		</Agent>
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
		<Agent name="UtilityMarket" id="4" type="DiscreteCommodityMarket">
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->			
			<Slot property="lastMarketPrice" value="1.0" />
			<Slot property="commodity" value="Utility"></Slot>
			<Slot property="currency" value="Money"></Slot>
			<Slot property="buyOffers">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="sellOffers">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="transactions">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
		</Agent>
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
		<Agents type="Laborer" rangeStartID="1000" rangeEndID="1174">
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
			<Slot property="assets">
				<ValueExpr language="Java">
					<![CDATA[ new ArrayList<aors.util.economics.Quantity>(){
				        {
				            Global.addContinuous(33.0d, "Food", "Stk", this);
				            Global.addContinuous(60.0d, "Money", "Stk", this);
				            Global.addContinuous(0.0d, "Labor", "Stk", this);
				            Global.addDiscrete(0, "Utility", this);
				        }
				    } ]]>
				</ValueExpr>
				<ValueExpr language="JavaScript">
					<![CDATA[ new js.util.ArrayList(minecon_laborfoodutility_scenario1.controller.Global.getContinuous(33.0, "Food", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(60.0, "Money", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(0.0, "Labor", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getDiscrete(0, "Utility")) ]]>
				</ValueExpr>
			</Slot>
			<Slot property="foodBuyList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript">new js.util.ArrayList()</ValueExpr>
			</Slot>
			<Slot property="foodSellList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript">new js.util.ArrayList()</ValueExpr>
			</Slot>
			<Slot property="laborSellList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript">new js.util.ArrayList()</ValueExpr>
			</Slot>
			<Slot property="utilityBuyList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript">new js.util.ArrayList()</ValueExpr>
			</Slot>
			<Slot property="owner" value="false"></Slot>
			<Slot property="foodAmount" value="33" />
			<Slot property="moneyAmount" value="60" />
			<Slot property="utilityAmount" value="0" />
			<Slot property="laborAmount" value="0" />
		</Agents>
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
		<Agents type="Owner" rangeStartID="2000" rangeEndID="2009">
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
			<Slot property="assets">
				<ValueExpr language="Java">
					<![CDATA[ new ArrayList<aors.util.economics.Quantity>(){
				        {
				            Global.addContinuous(33.0d, "Food", "Stk", this);
				            Global.addContinuous(90.0d, "Money", "Stk", this);
				            Global.addContinuous(0.0d, "Labor", "Stk", this);
				            Global.addDiscrete(0, "Utility", this);
				        }
				    } ]]>
				</ValueExpr>
				<ValueExpr language="JavaScript">
					<![CDATA[ new js.util.ArrayList(minecon_laborfoodutility_scenario1.controller.Global.getContinuous(33.0, "Food", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(90.0, "Money", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(0.0, "Labor", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getDiscrete(0, "Utility")) ]]>
				</ValueExpr>
			</Slot>
			<Slot property="foodBuyList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="foodSellList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="laborSellList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="utilityBuyList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="owner" value="true"></Slot>
			<Slot property="foodAmount" value="33" />
			<Slot property="moneyAmount" value="90" />
			<Slot property="utilityAmount" value="0" />
			<Slot property="laborAmount" value="0" />
		</Agents>
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
		<Agents type="Farm" rangeStartID="3000" rangeEndID="3004">
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
			<Slot property="assets">
				<ValueExpr language="Java">
					<![CDATA[ new ArrayList<aors.util.economics.Quantity>(){
				        {
				            Global.addContinuous(20.0d, "Food", "Stk", this);
				            Global.addContinuous(100.0d, "Money", "Stk", this);
				            Global.addContinuous(0.0d, "Labor", "Stk", this);
				            Global.addDiscrete(0, "Utility", this);
				        }
				    } ]]>
				</ValueExpr>
				<ValueExpr language="JavaScript">
					<![CDATA[ new js.util.ArrayList(minecon_laborfoodutility_scenario1.controller.Global.getContinuous(20.0, "Food", "Stk"),
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(100.0, "Money", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(0.0, "Labor", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getDiscrete(0, "Utility")) ]]>
				</ValueExpr>
			</Slot>
			<Slot property="buyList">
				<ValueExpr language="Java"><![CDATA[new ArrayList<TradeOffer>()]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[new js.util.ArrayList()]]></ValueExpr>
			</Slot>
			<Slot property="sellList">
				<ValueExpr language="Java"><![CDATA[new ArrayList<TradeOffer>()]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[new js.util.ArrayList()]]></ValueExpr>
			</Slot>
			<Slot property="foodAmount" value="20" /> 
			<Slot property="moneyAmount" value="100" />
			<Slot property="utilityAmount" value="0" />
			<Slot property="laborAmount" value="0" />
		</Agents>
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
		<Agents type="Factory" rangeStartID="4000" rangeEndID="4004">
		<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->		
			<Slot property="assets">
				<ValueExpr language="Java">
					<![CDATA[ new ArrayList<aors.util.economics.Quantity>(){
					  {	
						Global.addContinuous(0.0d, "Food", "Stk", this);
						Global.addContinuous(100.0d, "Money", "Stk", this);
						Global.addContinuous(0.0d, "Labor", "Stk", this);
						Global.addDiscrete(5, "Utility", this);
					  }
				    } ]]>
				</ValueExpr>
				<ValueExpr language="JavaScript">
					<![CDATA[ new js.util.ArrayList(minecon_laborfoodutility_scenario1.controller.Global.getContinuous(0.0, "Food", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(100.0, "Money", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getContinuous(0.0, "Labor", "Stk"), 
						minecon_laborfoodutility_scenario1.controller.Global.getDiscrete(5, "Utility")) ]]>
				</ValueExpr>
			</Slot>
			<Slot property="buyList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="sellList">
				<ValueExpr language="Java"><![CDATA[ new ArrayList<TradeOffer>() ]]></ValueExpr>
				<ValueExpr language="JavaScript"><![CDATA[ new js.util.ArrayList() ]]></ValueExpr>
			</Slot>
			<Slot property="moneyAmount" value="100" />
			<Slot property="utilityAmount" value="5" />
			<Slot property="laborAmount" value="0" />
			<Slot property="foodAmount" value="0" />
		</Agents>
		<ExogenousEvent type="Init" occurrenceTime="1" />
		<ExogenousEvent occurrenceTime="1" type="StartOfDay" />
		<ExogenousEvent occurrenceTime="3" type="StartWork" />
		<ExogenousEvent occurrenceTime="6" type="CloseMarket" />
	</InitialState>
	
	<!-- =================================================== -->
	<UserInterface>
		<StatisticsUI>
			<StatisticsVariableUI variable="PriceFood" comparisonGroup="pricevsfood">
				<Label>
					<Text xml:lang="en">FoodPrice</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">Average price of the foodmarket</Text>
				</Hint>
				<Format decimalPlaces="2">
					<Currency>EUR(&#8364;)</Currency>
				</Format>
			</StatisticsVariableUI>
			<StatisticsVariableUI variable="BuyOffersFood" comparisonGroup="pricevsfood">
				<Label>
					<Text xml:lang="en">Food BuyOffers</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">number of buyoffers for food</Text>
				</Hint>
			</StatisticsVariableUI>
			<StatisticsVariableUI variable="SellOffersFood" comparisonGroup="pricevsfood">
				<Label>
					<Text xml:lang="en">Food SellOffers</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">number of selloffers for food</Text>
				</Hint>
			</StatisticsVariableUI>
			<StatisticsVariableUI variable="PriceLabor" comparisonGroup="pricevslabor">
				<Label>
					<Text xml:lang="en">LaborPrice</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">Average price of the labormarket</Text>
				</Hint>
				<Format decimalPlaces="2">
					<Currency>EUR(&#8364;)</Currency>
				</Format>
			</StatisticsVariableUI>
			<StatisticsVariableUI variable="BuyOffersLabor" comparisonGroup="pricevslabor">
				<Label>
					<Text xml:lang="en">Labor BuyOffers</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">number of buyoffers for labor</Text>
				</Hint>
			</StatisticsVariableUI>
			<StatisticsVariableUI variable="SellOffersLabor" comparisonGroup="pricevslabor">
				<Label>
					<Text xml:lang="en">Labor SellOffers</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">number of selloffers for labor</Text>
				</Hint>
				</StatisticsVariableUI>
			<StatisticsVariableUI variable="PriceUtility" comparisonGroup="pricevsutility">
				<Label>
					<Text xml:lang="en">UtilityPrice</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">Average price of the utilitymarket</Text>
				</Hint>
				<Format decimalPlaces="2">
					<Currency>EUR(&#8364;)</Currency>
				</Format>
			</StatisticsVariableUI>
			<StatisticsVariableUI variable="BuyOffersUtility" comparisonGroup="pricevsutility">
				<Label>
					<Text xml:lang="en">Utility BuyOffers</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">number of buyoffers for utility</Text>
				</Hint>
			</StatisticsVariableUI>
			<StatisticsVariableUI variable="SellOffersUtility" comparisonGroup="pricevsutility">
				<Label>
					<Text xml:lang="en">Utility SellOffers</Text>
				</Label>
				<Hint>
					<Text xml:lang="en">number of selloffers for labor</Text>
				</Hint>
			</StatisticsVariableUI>
			
		</StatisticsUI>
		<AnimationUI>
			<DisplayDescription>
				<HtmlText></HtmlText>
			</DisplayDescription>
			
			<Views></Views>
		</AnimationUI>
		
	</UserInterface>
</SimulationScenario>
