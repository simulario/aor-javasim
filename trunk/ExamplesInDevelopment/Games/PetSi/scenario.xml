<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="prettyprint.xsl"?>
<SimulationScenario xmlns="http://aor-simulation.org"
	xmlns:aors="http://aor-simulation.org"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://aor-simulation.org ../../../AORSL/AORSL_0-9.xsd"
  version="0.9" simulationManagerDirectory="../../.."
  scenarioName="PetSi" scenarioTitle="PetSi: The Pet Simulation Game">

  <SimulationParameters simulationSteps="99999999999" stepDuration="1"
timeUnit="s" stepTimeDelay="10" randomSeed="100"/>
  <SimulationModel modelName="PetSi" modelTitle="petSi">
    <documentation>
      <dc:creator>Gerd Wagner</dc:creator>
    	<dc:created>20110808</dc:created>
      <dc:modified>20110808</dc:modified>
    </documentation>

  	<DataTypes>
  		<Enumeration name="SexEL">
  			<EnumerationLiteral>MALE</EnumerationLiteral>
  			<EnumerationLiteral>FEMALE</EnumerationLiteral>
  		</Enumeration>
  		<Enumeration name="DogBreedEL">
  			<EnumerationLiteral>MALAMUTE</EnumerationLiteral>
  			<EnumerationLiteral>BASSET</EnumerationLiteral>
  			<EnumerationLiteral>TERRIER</EnumerationLiteral>
  			<EnumerationLiteral>SHEPHERD</EnumerationLiteral>
  		</Enumeration>
  		<Enumeration name="DogLocationEL">
  			<EnumerationLiteral>LIVINGROOM</EnumerationLiteral>
  			<EnumerationLiteral>KITCHEN</EnumerationLiteral>
  			<EnumerationLiteral>SLEEP_PLACE</EnumerationLiteral>
  			<EnumerationLiteral>GARDEN</EnumerationLiteral>
  			<EnumerationLiteral>STREET</EnumerationLiteral>
  		</Enumeration>
  		<Enumeration name="HorseBreedEL">
  			<EnumerationLiteral>ARABIAN</EnumerationLiteral>
  			<EnumerationLiteral>FRIESIAN</EnumerationLiteral>
  			<EnumerationLiteral>WARMBLOOD</EnumerationLiteral>
  			<EnumerationLiteral>COLDBLOOD</EnumerationLiteral>
  		</Enumeration>
  		<Enumeration name="CatBreedEL">
  			<EnumerationLiteral>ABYSSINIAN</EnumerationLiteral>
  			<EnumerationLiteral>LONGHAIR</EnumerationLiteral>
  			<EnumerationLiteral>SHORTHAIR</EnumerationLiteral>
  		</Enumeration>
  		<Enumeration name="QuantityUnitEL">
  			<EnumerationLiteral>PIECE</EnumerationLiteral>
  			<EnumerationLiteral>MG</EnumerationLiteral>
  			<EnumerationLiteral>G</EnumerationLiteral>
  			<EnumerationLiteral>KG</EnumerationLiteral>
  			<EnumerationLiteral>ML</EnumerationLiteral>
  			<EnumerationLiteral>LTR</EnumerationLiteral>
  		</Enumeration>
  		<Enumeration name="SupplyUnitEL">
  			<EnumerationLiteral>CRATE</EnumerationLiteral>
  			<EnumerationLiteral>CAN</EnumerationLiteral>
  			<EnumerationLiteral>CUP</EnumerationLiteral>
  			<EnumerationLiteral>BAG</EnumerationLiteral>
  			<EnumerationLiteral>PIECE</EnumerationLiteral>
  		</Enumeration>
  	</DataTypes>
  	
	<Globals>
		<GlobalVariable name="foodPriceFactor" dataType="Float"/>
		<GlobalVariable name="petPriceFactor" dataType="Float"/>
	</Globals>

	<EntityTypes>
		<ExogenousEventType name="StartOfNewDay">
			<EnumerationProperty name="weatherType" type="WeatherTypeEL"/>			
		</ExogenousEventType>
		<!-- Animal actions -->
		<ActionEventType name="FallAsleep"/>
		<ActionEventType name="WakeUp"/>		
		<ActionEventType name="MakeDroppings"/>
		<ActionEventType name="Eat">
			<ReferenceProperty name="food" type="FoodType"/>
			<Attribute name="quantity" type="Float"/>
		</ActionEventType>
		<ActionEventType name="Drink">
			<Attribute name="quantity" type="Float"/>
		</ActionEventType>
		<!-- Player actions -->
		<ActionEventType name="Feed">
			<ReferenceProperty name="pet" type="Animal"/>			
			<ReferenceProperty name="food" type="FoodType"/>
			<Attribute name="quantity" type="Float"/>
		</ActionEventType>
		<ActionEventType name="Water">
			<ReferenceProperty name="pet" type="Animal"/>			
			<Attribute name="quantity" type="Float"/>
		</ActionEventType>
		<ActionEventType name="CleanUpDroppings">
			<ReferenceProperty name="pet" type="Animal"/>			
		</ActionEventType>
		<ActionEventType name="GoForWalk">
			<ReferenceProperty name="pet" type="Animal"/>
			<Attribute name="lengthOfWalk" type="Float"/>
		</ActionEventType>
		<ActionEventType name="MakeOlder">
			<ReferenceProperty name="pet" type="Animal"/>
			<Attribute name="numberOfMonths" type="Integer"/>
		</ActionEventType>
		<!-- Player perceptions -->
		
		<ObjectType name="FoodType">
			<EnumerationProperty name="quantityUnit" type="QuantityUnitEL"/>
			<EnumerationProperty name="supplyUnit" type="SupplyUnitEL"/>
			<Attribute name="quantityPerSupplyUnit" type="Integer"/>
			<Attribute name="purchasePrice" type="Float"/>
			<!-- Carbohydrates contain 15.8 kj/g, proteins 16.8 kj/g and fats 37.8 kj/g (kj/g = kilojoules per gram) -->
			<!-- 1 Calorie = 1 kilocalorie = 4.184 kilojoules -->
			<Attribute name="nutritionalValue" type="Float"/> <!-- in kilojoules per gram -->
			<Attribute name="carbohydrates" type="Float"/> <!-- in gram per quantity unit -->
			<Attribute name="fats" type="Float"/> <!-- in gram per quantity unit -->
			<Attribute name="proteins" type="Float"/> <!-- in gram per quantity unit -->
		</ObjectType>

		<AgentType name="Animal">
			<EnumerationProperty name="sex" type="SexEL"/>
			<Attribute name="dateOfBirth" type="Date"/>
			<!-- The age is measured in months -->
			<Attribute name="age" type="Integer" minValue="0"/> 
			<Attribute name="weight" type="Float"/>
			<Attribute name="energyLevel" type="Float"/>
			<Attribute name="healthLevel" type="Float"/>
			<ReferenceProperty name="owner" type="PetOwner"/>
			<ReferenceProperty name="favoriteFoodType" type="FoodType" lowerMultiplicity="0"/>
		</AgentType>

		<AgentType name="Dog" superType="Animal">
			<!-- Species Properties -->
			<!-- Average life expectancy in number of months (if a session corresponds to a month) -->
			<Attribute name="avgLifeExpectancy" type="Integer" isStatic="true" initialValue="120"/>
			<ReferenceProperty name="preferredFoodTypes" type="FoodType" upperMultiplicity="unbounded"/>
			<!-- Intake in gram per day and kg/m2 (based on BMI) -->
			<Attribute name="requiredCarbohydrateIntake" type="Integer" isStatic="true" initialValue="5"/>
			<Attribute name="requiredFatIntake" type="Integer" isStatic="true" initialValue="10"/>
			<Attribute name="requiredProteinIntake" type="Integer" isStatic="true" initialValue="20"/>
			
			<!-- Individual Properties -->
			<EnumerationProperty name="breed" type="DogBreedEL"/>
			<EnumerationProperty name="location" type="DogLocationEL"/>
			<Attribute name="size" type="Float"/>  <!-- how is the size of a dog defined? -->
			
<!--
 			<PeriodicTimeEventType name="SomeIllness">
				<Periodicity>
					<DiscreteRandomVariable>
						<UniformInt lowerBound="1" upperBound="50000" />
					</DiscreteRandomVariable>
				</Periodicity>
			</PeriodicTimeEventType>
			<ReactionRule name="SomeIllness_Rule" agentVariable="d">
				<documentation>
					<dc:description>Processes the SomeIllness event.</dc:description>
				</documentation>
				<WHEN eventType="SomeIllness"/>
				<DO>
					<UPDATE-AGT>
							<Slot property="healthIndex">
								<ValueExpr language="Java"> d.getHealth() - Random.uniformInt(15,35) </ValueExpr>
							</Slot>
					</UPDATE-AGT>
				</DO>
			</ReactionRule>
-->
		</AgentType>
		
		<AgentType name="PetOwner">
			<Attribute name="availableMoney" type="Integer"/>
			<ReferenceProperty name="ownedPets" type="Animal" upperMultiplicity="unbounded"/>
		</AgentType>

	</EntityTypes>


	<EnvironmentRules>
		<EnvironmentRule name="GainOfEnergy_ER">
			<documentation>
				<dc:description>When the dog is relaxing, or feeding, or when it is receiving attention and care.</dc:description>
			</documentation>
			<WHEN eventType="SomeIllness"/>
			<DO>
				<UPDATE-ENV>
					<UpdateObject>
						<Slot property="healthIndex">
							<ValueExpr language="Java"> d.getHealth() - Random.uniformInt(15,35) </ValueExpr>
						</Slot>						
					</UpdateObject>
				</UPDATE-ENV>
			</DO>
		</EnvironmentRule>
		<EnvironmentRule name="RandomPricechange_Rule">
			<ON-EACH-SIMULATION-STEP/>
			<IF language="Java">(Random.uniformInt(1,100) > 85)</IF>
			<THEN>
				<UPDATE-ENV>
					<UpdateGlobalVariable name="foodPriceFactor">
						<ValueExpr language="Java">
							<![CDATA[
								(Random.uniformInt(1,11) >
5)?(Global.getFoodPriceFactor()+0.05):(Global.getFoodPriceFactor()-0.05)
							]]>
						</ValueExpr>
					</UpdateGlobalVariable>
				</UPDATE-ENV>
			</THEN>
		</EnvironmentRule>
	</EnvironmentRules>
  </SimulationModel>

  <InitialState>

	<!-- init global variables -->
	<GlobalVariable name="foodPriceFactor" value="1.0"/>
	<GlobalVariable name="petPriceFactor" value="1.0"/>

	<!-- create a player -->
	<PhysicalAgent type="Player" id="1" name="Player">
		<Slot property="availableMoney"><ValueExpr language="Java"><![CDATA[ 200 ]]></ValueExpr></Slot>
	</PhysicalAgent>

    <!-- create one horse -->
    <PhysicalAgent type="Pet" id="2" name="Horse" m="10"
perceptionRadius="2" width="2" height="1" x="10" y="10" vx="0" vy="0">
		<Slot property="petType"><ValueExpr language="Java"><![CDATA[
Pets.HORSE ]]></ValueExpr></Slot>
		<Slot property="petBreed"><ValueExpr language="Java"><![CDATA[
Breeds.ARABIAN ]]></ValueExpr></Slot>
		<Slot property="petGender"><ValueExpr language="Java"><![CDATA[
1 ]]></ValueExpr></Slot>
		<Slot property="petDateOfBirth"><ValueExpr language="Java"><![CDATA[
(System.currentTimeMillis() / 1000) ]]></ValueExpr></Slot>
		<Slot property="petname"><ValueExpr language="Java"><![CDATA[
"Pferdchen" ]]></ValueExpr></Slot>
		<Slot property="petSize"><ValueExpr language="Java"><![CDATA[
0.5 ]]></ValueExpr></Slot>
		<Slot property="petWeight"><ValueExpr language="Java"><![CDATA[
125.0 ]]></ValueExpr></Slot>
		<Slot property="petMorale"><ValueExpr language="Java"><![CDATA[
100 ]]></ValueExpr></Slot>
		<Slot property="petEnergy"><ValueExpr language="Java"><![CDATA[
100 ]]></ValueExpr></Slot>
		<Slot property="petHealth"><ValueExpr language="Java"><![CDATA[
100 ]]></ValueExpr></Slot>
	</PhysicalAgent>

  </InitialState>
</SimulationScenario>
