<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="prettyprint.xsl"?>

<SimulationScenario version="0.9" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://aor-simulation.org ../../../AORSL/AORSL_0-9.xsd"
    xmlns="http://aor-simulation.org" xmlns:aors="http://aor-simulation.org"
    xmlns:dc="http://purl.org/dc/elements/1.1/" scenarioName="University_OrganizationVersion"
    scenarioTitle="An example of how the Universty works"
    simulationManagerDirectory="../../..">
    
    <SimulationParameters simulationSteps="100" timeUnit="h" stepDuration="1"/>
    <SimulationModel modelName="University_OrganizationVersion" modelTitle="An example of how the Universty works">
        <documentation>
            <description>As a car enters from the street, the driver, who we will call Fred, decides whether or not to get in line. If Fred decides to leave the restaurant, he leaves as a dissatisfied customer. One of the great things about a simulation is that it is easy to track these type of customers. In most real-world systems, it is usually difficult to track lostCustomers who leave dissatisfied. If Fred decides to get in line, then he waits until the menu board (with the speaker no normal human being can understand) is available. At that time, Fred gives the order to the order taker. After the order is taken, then two things occur simultaneously: (1) Fred moves forward if there is room. If there is no room, then he has to wait at the menu board until there is room to move forward. As soon as there is room, he moves so the next customer can order. (2) The order is sent electronically back to the kitchen where it is prepared as soon as the cook is available. As soon as Fred reaches the pickup window, then he pays and picks up his food, if it is ready. If the food is not ready, then Fred has to wait until his order is prepared.</description>
            <dc:created>20111114</dc:created>
            <dc:creator>Duca Bogdan</dc:creator>
            <dc:contributor>Oana Nicolae</dc:contributor>
        </documentation>
        
        <Statistics>
            <!--
            <Variable name="CourseAttending" dataType="Integer">
                <Source computeOnlyAtEnd="true" aggregationFunction="avg">
                    <ObjectProperty property="atTheCourse" objectType="Student"/>
                </Source>
            </Variable>
            -->
        </Statistics>
       
      <EntityTypes>
          <!-- =================================================== -->
          <ExogenousEventType name="StartAcademicYear" />
          <!-- =================================================== -->
          <CausedEventType name="StartOfCourse" />
          <!-- =================================================== -->
          <CausedEventType name="EndOfCourse" />
          <!-- =================================================== -->
          <ObjectType name="Course">
          <!-- =================================================== -->
              <Attribute type="Integer" name="courseId" />
              <Attribute type="String" name="courseName" />
              <Attribute type="Integer" name="maxNrOfStudents" />
              <Attribute type="String" name="moduleType"/>
              <Attribute type="String" name="period" />
              <Attribute type="String" name="language" />
          </ObjectType>
          <!-- =================================================== -->
          <ObjectType name="OrganizationChart">
          <!-- =================================================== -->
              <Attribute type="String" name="founded" />
              <Attribute type="String" name="address" />
              <Attribute type="String" name="termsOfOperation" />
          </ObjectType>
          <!-- =================================================== 
              Here we introduce the people with different roles.
              =================================================== -->
          <!-- =================================================== -->
          <AgentType name="Person">
           <!-- =================================================== -->
              <Attribute type="String" name="firstName" />
              <Attribute type="String" name="lastName" />
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="Student" superType="Person">
           <!-- =================================================== -->
              <Attribute type="Integer" name="matriculationNr" />
              <Attribute type="Boolean" name="atTheCourse" />
              <Attribute type="String" name="degree" />
              <Attribute type="String" name="fieldOfStudy" />
              <Attribute type="String" name="semesterOfStudy" />
              <ReferenceProperty name="courseList" type="Course" upperMultiplicity="unbounded"/>
              <!-- Function created to simulate the mood of the student concerning the course -->
              <Function name="courseChance" resultType="Boolean">
                   <Body language="Java"><![CDATA[
int r = Random.uniformInt(0,1);
	 if (r==0)  return (false);            // with probability  0.50
	             return (true);            // with probability  0.50
		     ]]></Body>
              </Function>
              <ReactionRule name="AttendCourse_Rule">
                  <WHEN eventType="CourseStart"/>
                  <DO>
                      <UPDATE-AGT>
                          <Slot property="atTheCourse" >
                              <ValueExpr language="Java">
                                  <![CDATA[
getCourseChance()
								]]></ValueExpr>
                          </Slot>
                      </UPDATE-AGT>
                  </DO>
              </ReactionRule>
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="Employee" superType="Person" />
          <!-- =================================================== -->
          <AgentType name="TechnicalStaff" superType="Employee">
              <!-- =================================================== -->
              <Attribute name="degree" type="String" />
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="Secretary" superType="Employee">
              <!-- =================================================== -->
              <Attribute name="degree" type="String" />
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="TeachingStaff" superType="Employee">
              <!-- =================================================== -->
              <Attribute name="degree" type="String" />  
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="Researcher" superType="Employee">
              <!-- =================================================== -->
              <Attribute name="degree" type="String" />  
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="Professor" superType="Employee">
              <!-- =================================================== -->
              <Attribute type="String" name="type"/>
              <Attribute type="Integer" name="startYear"/>
              <Attribute type="String" name="chair"/>
              <Attribute type="Boolean" name="atTheCourse"/>
              <ReferenceProperty name="modulesList" type="Course" upperMultiplicity="unbounded" />
              <!-- =================================================== -->
              <ReactionRule name="TeachCourse_Rule">
                  <!-- =================================================== -->
                  <WHEN eventType="CourseStart"/>
                  <DO>
                      <UPDATE-AGT>
                          <Slot property="atTheCourse" value="true"/>
                      </UPDATE-AGT>
                  </DO>
              </ReactionRule>
              <!-- =================================================== -->
              <ReactionRule name="CourseEnd">
                  <!-- =================================================== -->
                  <WHEN eventType="CourseEnd"/>
                  <DO>
                      <UPDATE-AGT>
                          <Slot property="atTheCourse" value="false" />
                      </UPDATE-AGT>
                  </DO>
              </ReactionRule>
          </AgentType>
          <!-- =================================================== 
              Defining the organization University and the corresponding
              sub organizations units. -->
          <!-- =================================================== -->
          <AgentType name="University">
              <!-- =================================================== -->
              <Attribute name="organizationName" type="String" />
              <ReferenceProperty name="organizationChart" type="OrganizationChart" />
              <ReferenceProperty name="faculties" type="Faculty" upperMultiplicity="unbounded" />
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="Faculty">
              <!-- =================================================== -->
              <ReferenceProperty name="studentsList" type="Student" upperMultiplicity="unbounded" />
              <ReferenceProperty name="chairs" type="Chair" upperMultiplicity="unbounded" />
          </AgentType>
          <!-- =================================================== -->
          <AgentType name="Chair">
              <!-- =================================================== -->
              <ReferenceProperty name="chairHolder" type="Professor" /> 
              <ReferenceProperty name="secretary" type="Secretary" />
              <ReferenceProperty name="employeesList" type="Employee" upperMultiplicity="unbounded"/>
          </AgentType>
         
      </EntityTypes>
        
      <EnvironmentRules>
          <!-- =================================================== -->
          <EnvironmentRule name="FacultyStart_Rule">
              <!-- =================================================== -->
              <WHEN eventType="FacultyStart"/>
              <DO>
                  <SCHEDULE-EVT>
                      <CausedEventExpr eventType="CourseStart">
                          <Delay>
                              <ValueExpr language="Java">2</ValueExpr>
                          </Delay>
                      </CausedEventExpr>
                  </SCHEDULE-EVT>
              </DO>
          </EnvironmentRule>
          <!-- =================================================== -->
          <EnvironmentRule name="CourseStart_Rule">
              <!-- =================================================== -->
              <WHEN eventType="CourseStart"/>
              <DO>
                  <SCHEDULE-EVT>
                      <CausedEventExpr eventType="CourseStart">
                          <Delay>
                              <ValueExpr language="Java">3</ValueExpr>
                          </Delay>
                      </CausedEventExpr>
                      <CausedEventExpr eventType="CourseEnd">
                          <Delay>
                              <ValueExpr language="Java">2</ValueExpr>
                          </Delay>
                      </CausedEventExpr>
                  </SCHEDULE-EVT>
               </DO>
          </EnvironmentRule>
      </EnvironmentRules>
    </SimulationModel>
    <!-- =================================================== -->
    <InitialState>
        <!-- =================================================== -->
        <ExogenousEvent type="FacultyStart" occurrenceTime="1"/>
        <!-- =================================================== -->
        <Agent type="Professor" name="Professor1" id="1">
            <!-- =================================================== -->
            <Slot property="firstName" value="Wagner"/>
            <Slot property="lastName" value="Gerd"/>
            <Slot property="chair" value="InternetTechnology"/>
            <Slot property="atTheCourse" value="false"/>
        </Agent>
        <!-- =================================================== -->
        <Agent type="Student" name="Student1" id="2">
            <!-- =================================================== -->
            <Slot property="firstName" value="Duca"/>
            <Slot property="lastName" value="Bogdan"/>
            <Slot property="matrikelNr" value="3053643"/>
            <Slot property="atTheCourse" value="false"/>
        </Agent>
        <!-- =================================================== -->
        <Agent type="Student" name="Student2" id="3">
            <!-- =================================================== -->
            <Slot property="firstName" value="Bobo"/>
            <Slot property="lastName" value="Greg"/>
            <Slot property="matrikelNr" value="3053622"/>
            <Slot property="atTheCourse" value="false"/>
        </Agent>
        <!-- =================================================== -->
        <Agent type="Student" name="Student3" id="4">
            <!-- =================================================== -->
            <Slot property="firstName" value="Smith"/>
            <Slot property="lastName" value="Tom"/>
            <Slot property="matrikelNr" value="3053612"/>
            <Slot property="atTheCourse" value="false"/>
        </Agent>
        <!-- =================================================== -->
        <Agent type="TechnicalStaff" name="TechnicalStaff1" id="5">
            <!-- =================================================== -->
            <Slot property="firstName" value="Doe"/>
            <Slot property="lastName" value="John"/>
            <Slot property="degree" value="Master"/>
        </Agent>
        <!-- =================================================== -->
        <Agent type="Researcher" name="Researcher1" id="6">
            <!-- =================================================== -->
            <Slot property="firstName" value="Seindfeld"/>
            <Slot property="lastName" value="Jerry"/>
            <Slot property="degree" value="Phd"/>
        </Agent>
        <!-- =================================================== -->
        <Agent type="University" name="BTU" id="7">
            <!-- =================================================== -->
            <Slot property="organizationName" value="BrandenburgischeTechnischeUniversitat"/>
        </Agent>
        <!-- =================================================== -->
        <Agent type="Faculty" name="Faculty" id="8">
            <!-- =================================================== -->
        </Agent>
        <Agent type="Chair" name="Internet-Technology" id="8">
            <!-- =================================================== -->
        </Agent>
    </InitialState>
    <!-- 
    <UserInterface supportedLanguages="en">
       
        <StatisticsUI>
       
            <StatisticsVariableUI variable="CourseAttending">
                <Label>
                    <Text xml:lang="en">Number of participants</Text>
                    <Text xml:lang="ro">Number of participants</Text>
                </Label>
                <Hint>
                    <Text xml:lang="en">How many participants are at the course?</Text>
                    <Text xml:lang="ro">Cati participanti sunt la curs?</Text>
                </Hint>
            </StatisticsVariableUI>
        </StatisticsUI>
        </UserInterface>
    -->
</SimulationScenario>