<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="prettyprint.xsl"?>

<SimulationScenario version="0.8.3" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://aor-simulation.org ../../../ext/aorsl/AORSL-0-8-3.xsd"
  xmlns="http://aor-simulation.org" xmlns:aors="http://aor-simulation.org"
  xmlns:dc="http://purl.org/dc/elements/1.1/" scenarioName="RobotsAndObjects"
  scenarioTitle="Robots and Objects in 2D space">

  <SimulationParameters simulationSteps="5000" stepDuration="1" timeUnit="s" stepTimeDelay="100"/>
  
  <SimulationModel modelName="RobotsAndObjects" modelTitle="RobotsAndObjects"
    autoKinematics="true" autoImpulse="true" autoCollision="true">

    <documentation>
      <dc:creator>Gerd Wagner</dc:creator>
      <dc:created>20091207</dc:created>
      <dc:description>Robots and different types of boxes move around in a 2D space. While
        robots exhibit active movement, boxes just move passively, driven by physical
        forces.</dc:description>
    </documentation>
  	
<!-- 
 		<SpaceModel><TwoDimensional xMax="500" yMax="500" geometry="Toroidal" spatialDistanceUnit="cm"/></SpaceModel>
-->
  	<SpaceModel dimensions="2" geometry="Toroidal" xMax="500" yMax="500" spatialDistanceUnit="cm"/>
    <EntityTypes>
      <PhysicalAgentType name="Robot"/>         
      <PhysicalObjectType name="Box1"/>
      <PhysicalObjectType name="Box2"/>
      <PhysicalObjectType name="Box3"/>
    </EntityTypes>

    <EnvironmentRules>
      <EnvironmentRule name="MoveRobots">
        <ON-EACH-SIMULATION-STEP/>
        <FOR objectVariable="r" objectType="Robot"/>
		  	<FOR dataVariable="dX" dataType="Integer">
		  		<ValueExpr language="Java">Random.uniformInt(0,1)</ValueExpr>
		  	</FOR>
		  	<FOR dataVariable="dY" dataType="Integer">
		  		<ValueExpr language="Java">Random.uniformInt(0,1)</ValueExpr>
		  	</FOR>
  		<DO>
  			<UPDATE-ENV>
  				<UpdateObject objectVariable="r">
  					<Slot property="x">
  						<ValueExpr language="Java">r.getX() + dX</ValueExpr>
  					</Slot>
  				</UpdateObject>
  				<UpdateObject objectVariable="r">
  					<Slot property="x">
  						<ValueExpr language="Java">r.getX() - dY</ValueExpr>
  					</Slot>
  				</UpdateObject>
  			</UPDATE-ENV>
  		</DO>
      </EnvironmentRule>
    </EnvironmentRules>

  </SimulationModel>

  <InitialState>
    <PhysicalObjects rangeStartID="1" rangeEndID="5" type="Box1" m="1" width="10"
      height="10" hasRandomPosition="true"/>
      
    <PhysicalObjects rangeStartID="6" rangeEndID="10" type="Box1" m="1" width="10"
      height="10" hasRandomPosition="true">
      <Slot property="vx">
      	<ValueExpr language="Java">Random.uniform(-0.05, 0.05)</ValueExpr>
      </Slot>
      <Slot property="vy">
      	<ValueExpr language="Java">Random.uniform(-0.05, 0.05)</ValueExpr>
      </Slot>
    </PhysicalObjects>
    
    <PhysicalObjects rangeStartID="11" rangeEndID="15" type="Box2" m="1" width="10"
      height="10" hasRandomPosition="true"/>
      
    <PhysicalObjects rangeStartID="16" rangeEndID="20" type="Box2" m="1" width="10"
      height="10" hasRandomPosition="true">
      <Slot property="vx">
      	<ValueExpr language="Java">Random.uniform(-0.1, 0.1)</ValueExpr>
      </Slot>
      <Slot property="vy">
      	<ValueExpr language="Java">Random.uniform(-0.1, 0.1)</ValueExpr>
      </Slot>
    </PhysicalObjects>
    
    <PhysicalObjects rangeStartID="21" rangeEndID="30" type="Box3" m="1" width="10"
    height="10" hasRandomPosition="true"/>
    
    <PhysicalAgents rangeStartID="100" rangeEndID="110" type="Robot" m="1" width="10"
      height="10" hasRandomPosition="true">
      <Slot property="ax">
        <ValueExpr language="Java">Random.uniform(-0.001, 0.001)</ValueExpr>
      </Slot>
      <Slot property="ay">
        <ValueExpr language="Java">Random.uniform(-0.001, 0.001)</ValueExpr>
      </Slot>
    </PhysicalAgents>
  </InitialState>

  <Views>
    <View physicalObjectType="Box1" shape2D="rectangle">
      <ShapeSlot shapeProperty="fill" value="blue"/>
    	<VisualizationMap  shapeProperty="height" property="height" mapType="polynomial" a1="13"/>
    </View>
    <View physicalObjectType="Box2" shape2D="rectangle">
      <ShapeSlot shapeProperty="fill" value="yellow"/>
      <ShapeSlot shapeProperty="width" value="10"/>
      <ShapeSlot shapeProperty="height" value="10"/>
    </View>
    <View physicalObjectType="Box3" shape2D="rectangle">
      <ShapeSlot shapeProperty="fill" value="red"/>
      <ShapeSlot shapeProperty="width" value="10"/>
      <ShapeSlot shapeProperty="height" value="10"/>
    </View>
    <View physicalObjectType="Robot" shape2D="rectangle">
      <ShapeSlot shapeProperty="fill" value="green"/>
      <ShapeSlot shapeProperty="width" value="10"/>
      <ShapeSlot shapeProperty="height" value="10"/>
    </View>
  </Views>
</SimulationScenario>
